
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Apuntes sobre Apache Hive, utilizando tablas internas y externas, realizando joins entre diferentes archivos HDFS.">
      
      
      
        <link rel="canonical" href="https://aitor-medrano.github.io/iabd/hadoop/hive1.html">
      
      
        <link rel="prev" href="flume.html">
      
      
        <link rel="next" href="hive2.html">
      
      
      <link rel="icon" href="../favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.8">
    
    
      
        <title>Apache Hive. Acceso a HDFS con un interfaz similar a tablas relacionales mediante SQL. - Inteligencia Artificial y Big Data</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-VKM8BDY6KT"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-VKM8BDY6KT",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-VKM8BDY6KT",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Apache Hive. Acceso a HDFS con un interfaz similar a tablas relacionales mediante SQL. - Inteligencia Artificial y Big Data" >
      
        <meta  property="og:description"  content="Apuntes sobre Apache Hive, utilizando tablas internas y externas, realizando joins entre diferentes archivos HDFS." >
      
        <meta  property="og:image"  content="https://aitor-medrano.github.io/iabd/assets/images/social/hadoop/hive1.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://aitor-medrano.github.io/iabd/hadoop/hive1.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Apache Hive. Acceso a HDFS con un interfaz similar a tablas relacionales mediante SQL. - Inteligencia Artificial y Big Data" >
      
        <meta  name="twitter:description"  content="Apuntes sobre Apache Hive, utilizando tablas internas y externas, realizando joins entre diferentes archivos HDFS." >
      
        <meta  name="twitter:image"  content="https://aitor-medrano.github.io/iabd/assets/images/social/hadoop/hive1.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hive-y-hadoop" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../index.html" title="Inteligencia Artificial y Big Data" class="md-header__button md-logo" aria-label="Inteligencia Artificial y Big Data" data-md-component="logo">
      
  <img src="../images/logoIABD3.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Inteligencia Artificial y Big Data
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Apache Hive. Acceso a HDFS con un interfaz similar a tablas relacionales mediante SQL.
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Inteligencia Artificial y Big Data" class="md-nav__button md-logo" aria-label="Inteligencia Artificial y Big Data" data-md-component="logo">
      
  <img src="../images/logoIABD3.png" alt="logo">

    </a>
    Inteligencia Artificial y Big Data
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../2324.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Planning 23/24
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    NoSQL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            NoSQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/nosql.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Almacenamiento de datos. NoSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/mongo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/modelado.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelado documental
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/agregaciones.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Agregaciones en MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/rendimiento.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rendimiento
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/replicacion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Replicación y particionado
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/pymongo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB y Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sa/series-temporales.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Series temporales
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cloud
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/cloud.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cloud
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/aws.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/s3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    S3
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/ec2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EC2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/lambda.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lambda
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/rds.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RDS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/dynamodb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DynamoDB
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/waf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WAF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/escalado.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Monitorización y Escalado
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/emr.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EMR
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/athena.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Athena
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cloud/glue.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glue
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ingeniería de Datos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Ingeniería de Datos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../de/bigdata.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Big Data
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../de/de.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ingeniería de datos
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../de/arq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arquitecturas Big Data
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../de/etl.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ingesta de datos
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../de/pentaho.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pentaho
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../de/formatos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Formatos de datos
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../de/faker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Faker
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Ecosistema Hadoop
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Ecosistema Hadoop
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="hadoop.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hadoop
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="hdfs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HDFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sqoop.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sqoop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="flume.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flume
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Hive I
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="hive1.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Hive I
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hive-y-hadoop" class="md-nav__link">
    <span class="md-ellipsis">
      Hive y Hadoop
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hive y Hadoop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#caracteristicas" class="md-nav__link">
    <span class="md-ellipsis">
      Características
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componentes" class="md-nav__link">
    <span class="md-ellipsis">
      Componentes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tipos-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Tipos de datos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instalacion-y-configuracion" class="md-nav__link">
    <span class="md-ellipsis">
      Instalación y configuración
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hola-mundo" class="md-nav__link">
    <span class="md-ellipsis">
      Hola Mundo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hola Mundo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acceso-remoto" class="md-nav__link">
    <span class="md-ellipsis">
      Acceso remoto
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caso-1-creacion-y-borrado-de-tablas" class="md-nav__link">
    <span class="md-ellipsis">
      Caso 1: Creación y borrado de tablas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caso-2-insertando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Caso 2: Insertando datos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caso 2: Insertando datos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cargando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Cargando datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insertando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Insertando datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modificando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Modificando datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingestando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Ingestando datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extrayendo-datos-insertados" class="md-nav__link">
    <span class="md-ellipsis">
      Extrayendo datos insertados
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caso-3-consultas-con-join" class="md-nav__link">
    <span class="md-ellipsis">
      Caso 3: Consultas con join
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caso 3: Consultas con join">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outer-join" class="md-nav__link">
    <span class="md-ellipsis">
      Outer join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semi-joins" class="md-nav__link">
    <span class="md-ellipsis">
      Semi-joins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map-joins" class="md-nav__link">
    <span class="md-ellipsis">
      Map joins
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comandos" class="md-nav__link">
    <span class="md-ellipsis">
      Comandos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caso-4-tabla-interna" class="md-nav__link">
    <span class="md-ellipsis">
      Caso 4: Tabla interna
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caso 4: Tabla interna">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#consultando-datos-compuestos" class="md-nav__link">
    <span class="md-ellipsis">
      Consultando datos compuestos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caso-5-tabla-externa" class="md-nav__link">
    <span class="md-ellipsis">
      Caso 5: Tabla externa
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    <span class="md-ellipsis">
      Referencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades" class="md-nav__link">
    <span class="md-ellipsis">
      Actividades
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="hive2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hive II
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Spark
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Spark
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/spark.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ecosistema Spark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/rdd.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RDD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/dataframeAPI.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataFrames API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/agregaciones.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Agregaciones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/catalog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark JDBC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/deltalake.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delta Lake
  </span>
  
    
  
  
    <span class="md-status md-status--updated" title="Modificado">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/streaming.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streaming I
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark/join-window.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streaming II
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Flujo de datos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Flujo de datos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/nifi1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nifi I
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/nifi2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nifi II
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/kafka1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kafka I
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/kafka2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kafka II
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataflow/airflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Airflow
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transferencia de conocimiento
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Transferencia de conocimiento
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hf/transferencia.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reaprendiendo
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hf/hf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hf/datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../audio/audio.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tratamiento de Audio
  </span>
  
    
  
  
    <span class="md-status md-status--new" title="Recién añadido">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../pia/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    PIA
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            PIA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_2" >
        
          
          <label class="md-nav__link" for="__nav_10_2" id="__nav_10_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lara 22/23
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_2">
            <span class="md-nav__icon md-icon"></span>
            Lara 22/23
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/01presentacion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Presentación
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/02requisitos.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prototipado
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/03visitaVK.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visita IES Victoria Kent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/04almacenamiento.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Almacenamiento datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/05audio.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Almacenamiento audio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/11dataset.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creando el dataset
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_3" >
        
          
          <label class="md-nav__link" for="__nav_10_3" id="__nav_10_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lara 23/24
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_3">
            <span class="md-nav__icon md-icon"></span>
            Lara 23/24
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/21conociendo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conociendo Lara
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/22captura.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Capturando audios
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/29dataset.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creando el dataset
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_4" >
        
          
          <label class="md-nav__link" for="__nav_10_4" id="__nav_10_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Autoponic 22/23
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_4">
            <span class="md-nav__icon md-icon"></span>
            Autoponic 22/23
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/06autoponic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Presentación
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/07navarrosantafe.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visita IES Navarro Santafé
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/08timeseries.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Almacenamiento datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/09powerbi.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualización
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/10actuadores.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actuadores
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_5" >
        
          
          <label class="md-nav__link" for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Autoponic 23/24
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_5">
            <span class="md-nav__icon md-icon"></span>
            Autoponic 23/24
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/23autoponic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conociendo Autoponic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/24nodered.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Node-RED
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/25villena.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visita IES Navarro Santafé
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/26modelo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelo de datos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pia/27dashboard.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cuadro de mandos
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tags.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tags
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../blog/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_12" id="__nav_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_2" >
        
          
          <label class="md-nav__link" for="__nav_12_2" id="__nav_12_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archivo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_2">
            <span class="md-nav__icon md-icon"></span>
            Archivo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/archive/2024.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/archive/2023.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12_3" >
        
          
          <label class="md-nav__link" for="__nav_12_3" id="__nav_12_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categorías
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_12_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12_3">
            <span class="md-nav__icon md-icon"></span>
            Categorías
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/2023.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/2024.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/diciembre.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diciembre
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/enero.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enero
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/febrero.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Febrero
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/marzo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Marzo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/noticias.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Noticias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/noviembre.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Noviembre
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/octubre.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Octubre
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/category/septiembre.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Septiembre
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#hive-y-hadoop" class="md-nav__link">
    <span class="md-ellipsis">
      Hive y Hadoop
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hive y Hadoop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#caracteristicas" class="md-nav__link">
    <span class="md-ellipsis">
      Características
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componentes" class="md-nav__link">
    <span class="md-ellipsis">
      Componentes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tipos-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Tipos de datos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instalacion-y-configuracion" class="md-nav__link">
    <span class="md-ellipsis">
      Instalación y configuración
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hola-mundo" class="md-nav__link">
    <span class="md-ellipsis">
      Hola Mundo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hola Mundo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acceso-remoto" class="md-nav__link">
    <span class="md-ellipsis">
      Acceso remoto
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caso-1-creacion-y-borrado-de-tablas" class="md-nav__link">
    <span class="md-ellipsis">
      Caso 1: Creación y borrado de tablas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caso-2-insertando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Caso 2: Insertando datos
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caso 2: Insertando datos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cargando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Cargando datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insertando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Insertando datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modificando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Modificando datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingestando-datos" class="md-nav__link">
    <span class="md-ellipsis">
      Ingestando datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extrayendo-datos-insertados" class="md-nav__link">
    <span class="md-ellipsis">
      Extrayendo datos insertados
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caso-3-consultas-con-join" class="md-nav__link">
    <span class="md-ellipsis">
      Caso 3: Consultas con join
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caso 3: Consultas con join">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outer-join" class="md-nav__link">
    <span class="md-ellipsis">
      Outer join
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semi-joins" class="md-nav__link">
    <span class="md-ellipsis">
      Semi-joins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map-joins" class="md-nav__link">
    <span class="md-ellipsis">
      Map joins
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comandos" class="md-nav__link">
    <span class="md-ellipsis">
      Comandos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caso-4-tabla-interna" class="md-nav__link">
    <span class="md-ellipsis">
      Caso 4: Tabla interna
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caso 4: Tabla interna">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#consultando-datos-compuestos" class="md-nav__link">
    <span class="md-ellipsis">
      Consultando datos compuestos
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caso-5-tabla-externa" class="md-nav__link">
    <span class="md-ellipsis">
      Caso 5: Tabla externa
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    <span class="md-ellipsis">
      Referencias
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#actividades" class="md-nav__link">
    <span class="md-ellipsis">
      Actividades
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <a href="../tags.html#hadoop" class="md-tag">Hadoop</a>
    
  
    
    
    
      <a href="../tags.html#hive" class="md-tag">Hive</a>
    
  
    
    
    
      <a href="../tags.html#sbd-ra3" class="md-tag">SBD RA3</a>
    
  
</nav>



  <h1>Hive I</h1>

<p><em>Apache Hive</em> (<a href="https://hive.apache.org/">https://hive.apache.org/</a>) es una tecnología distribuida diseñada y construida sobre un clúster de <em>Hadoop</em>. Permite leer, escribir y gestionar grandes <em>datasets</em> (con escala de petabytes) que residen en HDFS haciendo uso de un lenguaje dialecto de SQL, conocido como <em>HiveSQL</em>, lo que simplifica mucho el desarrollo y la gestión de <em>Hadoop</em>.</p>
<figure style="float: right;">
    <img src="images/06hive-logo.jpg" alt="Logo de Apache Hive">
    <figcaption>Logo de Apache Hive</figcaption>
</figure>

<p>El proyecto lo inició <em>Facebook</em> para conseguir que la interacción con <em>Hadoop</em> fuera similar a la que se realiza con un <em>datawarehouse</em> tradicional. La tecnología <em>Hadoop</em> es altamente escalable, aunque hay que destacar su dificultad de uso y que está orientado únicamente a operaciones <em>batch</em>, con lo que no soporta el acceso aleatorio ni está optimizado para ficheros pequeños.</p>
<h2 id="hive-y-hadoop">Hive y Hadoop<a class="headerlink" href="#hive-y-hadoop" title="Permanent link">&para;</a></h2>
<p>Si volvemos a ver como casa <em>Hive</em> dentro del ecosistema de <em>Hadoop</em>, <em>Hive</em> es una fachada construida sobre Hadoop que permite acceder a los datos almacenados en HDFS de forma muy sencilla sin necesidad de conocer <em>Java</em>, <em>Map Reduce</em> u otras tecnologías.</p>
<p>Aunque en principio estaba diseñado para el procesamiento <em>batch</em>, ahora se integra con frameworks en <em>streaming</em> como <em>Tez</em> y <em>Spark</em>.</p>
<figure style="align: center;">
    <img src="images/03hadoop-ecosystem01.jpg" alt="Ecosistema Hadoop">
    <figcaption>Ecosistema Hadoop</figcaption>
</figure>

<h3 id="caracteristicas">Características<a class="headerlink" href="#caracteristicas" title="Permanent link">&para;</a></h3>
<p><em>Hive</em> impone una estructura sobre los datos almacenados en HDFS. Esta estructura se conoce como <strong><em>Schema</em></strong>, y <em>Hive</em> la almacena en su propia base de datos (<em>metastore</em>). Gracias a ella, optimiza de forma automática el plan de ejecución y usa particionado de tablas en determinadas consultas. También soporta diferentes formatos de ficheros, codificaciones y fuentes de datos como <em>HBase</em>.</p>
<p>Para interactuar con <em>Hive</em> utilizaremos <em>HiveQL</em>, el cual es un dialecto de <em>SQL</em> (recuerda que <em>SQL</em> no es sensible a las mayúsculas, excepto en la comparación de cadenas).</p>
<p><em>Hive</em> amplía el paradigma de <em>SQL</em> incluyendo formatos de serialización. También podemos personalizar el procesamiento de consultas creando un esquema de tabla acorde con nuestros datos, pero sin tocar los datos. Aunque SQL solo es compatible con tipos de valor primitivos (como fechas, números y cadenas), los valores de las tablas de <em>Hive</em> son elementos estructurados, por ejemplo, objetos JSON o cualquier tipo de datos definido por el usuario o cualquier función escrita en Java.</p>
<p>Una consulta típica en <em>Hive</em> se ejecuta en varios <em>datanodes</em> en paralelo, con varios trabajos <em>MapReduce</em> asociados. Estas operaciones son de tipo <em>batch</em>, por lo que la latencia es más alta que en otros tipos de bases de datos. Además, hay que considerar el retardo producido por la inicialización de los trabajos, sobre todo en el caso de consultar pequeños <em>datasets</em>.</p>
<h4 id="ventajas">Ventajas<a class="headerlink" href="#ventajas" title="Permanent link">&para;</a></h4>
<p>Las ventajas de utilizar <em>Hive</em> son:</p>
<ul>
<li>Reduce la complejidad de la programación <em>MapReduce</em> al usar <em>HiveQL</em> como lenguaje de consulta.</li>
<li>Está orientado a aplicaciones de tipo <em>Data Warehouse</em>, con datos estáticos, poco cambiantes y sin requisitos de tiempos de respuesta rápidos.</li>
<li>Permite a los usuarios despreocuparse de en qué formato y dónde se almacenan los datos.</li>
<li>Incorpora <em>Beeline</em>: una herramienta por línea de comandos para realizar consultas con <em>HiveQL</em>.</li>
</ul>
<p>En cambio, <em>Hive</em> no es la mejor opción para consultas en tiempo real o de tipo transaccional. Además, no está diseñado para usarse con actualizaciones de valores al nivel de registro, y el soporte de SQL es limitado.</p>
<h4 id="alternativas">Alternativas<a class="headerlink" href="#alternativas" title="Permanent link">&para;</a></h4>
<p>Una de las alternativas más populares es <a href="https://impala.apache.org/">Apache Impala</a>, originalmente creado por <em>Cloudera</em>, el cual utiliza un demonio dedicado en cada <em>datanode</em> del clúster, de manera que hay un coordinador que reenvía a cada <em>datanode</em> la consulta a realizar y luego se encarga de unir los datos en el resultado final. <em>Impala</em> utiliza el <em>metastore</em> de <em>Hive</em> y soporta la mayoría de construcciones de <em>Hive</em>, con lo que la migración de un sistema a otro es sencilla.</p>
<p>En lugar de utilizar <em>MapReduce</em>, aprovecha un motor de procesamiento masivo en paralelo (MPP) como el que existe en los sistemas gestores de bases de datos relacionales (RDBMS). Esta arquitectura hace que <em>Impala</em> sea adecuado para análisis interactivos y de baja latencia.</p>
<!--
https://aws.amazon.com/es/emr/faqs/#Using_Impala
-->

<p>Otras alternativas <em>open source</em> son :</p>
<ul>
<li><a href="http://prestodb.io/">Presto de Facebook</a> y <a href="http://drill.apache.org/">Apache Drill</a>, con arquitecturas muy similares a <em>Impala</em>.</li>
<li><a href="https://spark.apache.org/sql/">Spark SQL</a>: utiliza <em>Spark</em> como motor de ejecución y permite utilizar consultas SQL embebidas. La estudiaremos en sesiones futuras.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Pig</p>
<p><a href="https://pig.apache.org">Apache Pig</a> es una herramienta que abstrae el acceso a <em>MapReduce</em> de forma similar a como lo realiza <em>Hive</em>, pero en vez de SQL, utiliza su propio lenguaje de <em>scripting</em> (<em>PigLatin</em>) para expresar los flujos de datos.
Actualmente ha perdido uso en detrimento de <em>Hive</em>/<em>Impala</em> y de <em>Spark</em>.</p>
<p>Tenéis una pequeña introducción en <a href="https://www.analyticsvidhya.com/blog/2021/08/an-introduction-to-apache-pig-for-absolute-beginners/">https://www.analyticsvidhya.com/blog/2021/08/an-introduction-to-apache-pig-for-absolute-beginners/</a>.</p>
</div>
<h3 id="componentes">Componentes<a class="headerlink" href="#componentes" title="Permanent link">&para;</a></h3>
<p>A continuación podemos ver un gráfico que relaciona los diferentes componentes de <em>Hive</em> y define su arquitectura:</p>
<figure style="align: center;">
    <img src="images/06hive-arq.png" alt="Arquitectura de Apache Hive">
    <figcaption>Arquitectura de Apache Hive</figcaption>
</figure>

<h4 id="hive-server">Hive Server<a class="headerlink" href="#hive-server" title="Permanent link">&para;</a></h4>
<p><em>HiveServer 2</em> (HS2) es la última versión del servicio. Se compone de una interfaz que permite a clientes externos ejecutar consultas contra <em>Apache Hive</em> y obtener los resultados. Está basado en <em>Thrift RPC</em> y soporta clientes concurrentes. Para arrancar el servidor, ejecutaremos el comando <code>hiveserver2</code>, el cual quedará a la escucha en el puerto <code>10000</code>.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>iabd@iabd-virtualbox:~$<span class="w"> </span>hiveserver2
<span class="linenos" data-linenos="2 "></span><span class="m">2023</span>-01-20<span class="w"> </span><span class="m">09</span>:39:51:<span class="w"> </span>Starting<span class="w"> </span>HiveServer2
<span class="linenos" data-linenos="3 "></span>SLF4J:<span class="w"> </span>Class<span class="w"> </span>path<span class="w"> </span>contains<span class="w"> </span>multiple<span class="w"> </span>SLF4J<span class="w"> </span>bindings.
<span class="linenos" data-linenos="4 "></span>SLF4J:<span class="w"> </span>...
<span class="linenos" data-linenos="5 "></span>Hive<span class="w"> </span>Session<span class="w"> </span><span class="nv">ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>9e39b0c8-45a6-46ca-bfb0-6e320c85f989
</code></pre></div>
<p>A este servidor nos conectaremos mediante la herramienta <em>Beeline</em> (Beeline CLI).</p>
<h4 id="hive-metastore">Hive Metastore<a class="headerlink" href="#hive-metastore" title="Permanent link">&para;</a></h4>
<p>Es el repositorio central para los metadatos de <em>Hive</em>, y se almacena en una base de datos relacional como <em>MySQL</em>, <em>PostgreSQL</em> o <em>Apache Derby</em> (embebida). Mantiene los metadatos, las tablas y sus tipos mediante <em>Hive DDL</em> (<em>Data Definition Language</em>). Además, el sistema se puede configurar para que también almacene estadísticas de las operaciones y registros de autorización para optimizar las consultas.</p>
<p>En las últimas versiones de <em>Hive</em>, este componente se puede desplegar de forma remota e independiente, para no compartir la misma JVM con <em>HiveServer</em>. Dentro del <em>metastore</em> podemos encontrar el <em>Hive Catalog</em> (<em>HCatalog</em>), que permite acceder a sus metadatos, actuando como una API. Al poder desplegarse de forma aislada e independiente, permite que otras aplicaciones hagan uso del <em>schema</em> sin tener que desplegar el motor de consultas de <em>Hive</em>.</p>
<figure style="float: left;">
    <img src="images/06hive-metastore-configurations.png" alt="Configuraciones del Metastore de Apache Hive" width="500">
    <figcaption>Configuraciones del Metastore de Apache Hive</figcaption>
</figure>

<p>En nuestra máquina, inicialmente tenemos instalada una versión local que permite varias conexiones simultáneas utilizando MySQL como almacén de los metadatos, aunque en el caso de uso 7 necesitaremos configurarlo como remoto para poder acceder a él desde Flume.</p>
<p>Así pues, al <em>Metastore</em> podremos acceder mediante <em>HiveCLI</em>, o a través del <em>Hive Server</em> mediante una conexión remota mediante <em>Beeline</em>.</p>
<div class="admonition info">
<p class="admonition-title">Metastore remoto</p>
<p>Para configurar el metastore en remoto, necesitamos modificar la propiedad <code>hive.metastore.uris</code> del archivo <code>hive-site.xml</code> situado en <code>$HIVE_HOME/conf</code>:</p>
<div class="highlight"><span class="filename">hive-site.xml</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nt">&lt;property&gt;</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="nt">&lt;name&gt;</span>hive.metastore.uris<span class="nt">&lt;/name&gt;</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="nt">&lt;value&gt;</span>thrift://iabd-virtualbox:9083<span class="nt">&lt;/value&gt;</span>
<span class="linenos" data-linenos="4 "></span><span class="nt">&lt;/property&gt;</span>
</code></pre></div>
<p>Una vez configurado, volvemos a arrancar <em>Hive</em> mediante <code>hiveserver2</code> y a continuación, cada vez que arranquemos <em>Hive</em>, necesitamos también arrancar el <em>Metastore</em>, ya que ahora funciona como un servicio totalmente desacoplado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>hive<span class="w"> </span>--service<span class="w"> </span>metastore
</code></pre></div>
</div>
<p>En la sesión de <a href="../spark/catalog.html"><em>Spark Catalog</em></a> veremos cómo desde una herramienta externa a <em>Hive</em>, se accede y utilizan los metadatos almacenados.</p>
<h4 id="beeline">Beeline<a class="headerlink" href="#beeline" title="Permanent link">&para;</a></h4>
<p><em>Hive</em> incorpora <em>Beeline</em>, el cual actúa como un cliente basado en JDBC para hacer consultas por línea de comandos contra el <em>Hive Server</em>, sin necesitar las dependencias de <em>Hive</em>, mediante el comando <code>beeline</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>iabd@iabd-virtualbox:~$<span class="w"> </span>beeline
<span class="linenos" data-linenos="2 "></span>SLF4J:<span class="w"> </span>Class<span class="w"> </span>path<span class="w"> </span>contains<span class="w"> </span>multiple<span class="w"> </span>SLF4J<span class="w"> </span>bindings.
<span class="linenos" data-linenos="3 "></span>SLF4J:<span class="w"> </span>...
<span class="linenos" data-linenos="4 "></span>Beeline<span class="w"> </span>version<span class="w"> </span><span class="m">3</span>.1.2<span class="w"> </span>by<span class="w"> </span>Apache<span class="w"> </span>Hive
<span class="linenos" data-linenos="5 "></span>beeline&gt;<span class="w"> </span>
</code></pre></div>
<p>Por otro lado, también podemos utilizar <em>Hive CLI</em>, un cliente basado en <em>Apache Thrift</em>, que usa los mismos drivers que <em>Hive</em>.</p>
<div class="admonition info">
<p class="admonition-title">Apache Tez y Spark</p>
<p>Hive 3 deja de soportar <em>MapReduce</em>. <em>Apache Tez</em> lo reemplaza como el motor de ejecución por defecto, de manera que mejora el rendimiento y se ejecuta sobre <em>Hadoop Yarn</em>, que encola y planifica los trabajos en el clúster. Además de <em>Tez</em>, <em>Hive</em> también puede utilizar <em>Apache Spark</em> como motor de ejecución.</p>
<p>Para indicar que queremos ejecutar <em>Tez</em> como motor de ejecución, ejecutaríamos el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>SET hive.execution.engine=tez;
</code></pre></div>
<p>En nuestro caso no tenemos <em>Tez</em> instalado en la máquina virtual, quedando fuera del alcance del presente curso.</p>
<p>Conviene distinguir que <em>Spark SQL</em> no tiene nada que ver con utilizar el motor de ejecución de <em>Spark</em> dentro de <em>Hive</em>. Al utilizar el motor de <em>Hive</em>, podemos hacer un uso completo de las características de Hive, mientras que <em>Spark SQL</em> es un motor diferente que ofrece una alta compatibilidad con <em>Hive</em>, pero tiene sus particularidades.</p>
</div>
<h3 id="tipos-de-datos">Tipos de datos<a class="headerlink" href="#tipos-de-datos" title="Permanent link">&para;</a></h3>
<p>Los tipos de datos que podemos emplear en <em>Hive</em> son muy similares a los que se utilizan en el DDL de SQL.
Los tipos simples más comunes son <code>STRING</code> e <code>INT</code>, aunque podemos utilizar otros tipos como <code>TINYINT</code>, <code>BIGINT</code>, <code>DOUBLE</code>, <code>DATE</code>, <code>TIMESTAMP</code>, etc...</p>
<p>Para realizar una conversión explicita de tipos, por ejemplo de un tipo texto a uno numérico, hay que utilizar la función <code>CAST</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tablaPruebas</span><span class="p">;</span>
</code></pre></div>
<p>Respecto a los tipos compuestos, tenemos tres tipos:</p>
<ul>
<li>arrays mediante el tipo <code>ARRAY</code>, para agrupar elementos del mismo tipo: <code>["manzana", "pera", "naranja]</code>.</li>
<li>mapas mediante el tipo <code>MAP</code>, para definir parejas de clave-valor: <code>{1: "manzana", 2: "pera"}</code></li>
<li>estructuras mediante el tipo <code>STRUCT</code>, para definir estructuras con propiedades: <code>{"fruta": "manzana", "cantidad": 1, "tipo": "postre"}</code>.</li>
</ul>
<h2 id="instalacion-y-configuracion">Instalación y configuración<a class="headerlink" href="#instalacion-y-configuracion" title="Permanent link">&para;</a></h2>
<div class="admonition important">
<p class="admonition-title">Máquina virtual</p>
<p>Los siguientes pasos no son necesarios ya que nuestra máquina virtual ya tiene <em>Hive</em> instalado y configurado correctamente. Si quieres hacer tu propia instalación sigue los siguientes pasos de la <a href="https://cwiki.apache.org/confluence/display/Hive//GettingStarted">documentación oficial</a>.</p>
</div>
<p>Una vez instalado vamos a configurarlo. Para ello, debemos crear los ficheros de configuración a partir de las plantilla que ofrece <em>Hive</em>. Para ello, desde la carpeta <code>$HIVE_HOME/conf</code>, ejecutaremos los siguientes comandos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>cp<span class="w"> </span>hive-default.xml.template<span class="w"> </span>hive-site.xml
<span class="linenos" data-linenos="2 "></span>cp<span class="w"> </span>hive-env.sh.template<span class="w"> </span>hive-env.sh
<span class="linenos" data-linenos="3 "></span>cp<span class="w"> </span>hive-exec-log4j2.properties.template<span class="w"> </span>hive-exec-log4j2.properties
<span class="linenos" data-linenos="4 "></span>cp<span class="w"> </span>hive-log4j2.properties.template<span class="w"> </span>hive-log4j2.properties
</code></pre></div>
<p>Modificamos el fichero <code>hive.env.sh</code> para incluir dos variables de entorno con las rutas de <em>Hadoop</em> y la configuración de <em>Hive</em></p>
<div class="highlight"><span class="filename">hive.env.sh</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">export</span><span class="w"> </span><span class="nv">HADOOP_HOME</span><span class="o">=</span>/opt/hadoop-3.3.1
<span class="linenos" data-linenos="2 "></span><span class="nb">export</span><span class="w"> </span><span class="nv">HIVE_CONF_DIR</span><span class="o">=</span>/opt/hive-3.1.2/conf
<span class="linenos" data-linenos="3 "></span><span class="nb">export</span><span class="w"> </span><span class="nv">HCAT_HOME</span><span class="o">=</span><span class="nv">$HIVE_HOME</span>/hcatalog
</code></pre></div>
<p>Para que funcione la ingesta de datos en <em>Hive</em> mediante <em>Sqoop</em>, necesitamos añadir una librería a <em>Sqoop</em>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>cp<span class="w"> </span><span class="nv">$HIVE_HOME</span>/lib/hive-common-3.1.2.jar<span class="w"> </span><span class="nv">$SQOOP_HOME</span>/lib
</code></pre></div>
<p>Y configuramos las variables de entorno de nuestro <em>path</em> para exportar las rutas de Hive y del <em>metastore</em>:</p>
<div class="highlight"><span class="filename">~/.bashrc</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">export</span><span class="w"> </span><span class="nv">HIVE_HOME</span><span class="o">=</span>/opt/hive-3.1.2
<span class="linenos" data-linenos="2 "></span><span class="nb">export</span><span class="w"> </span><span class="nv">HIVE_CONF_DIR</span><span class="o">=</span><span class="nv">$HIVE_HOME</span>/conf
<span class="linenos" data-linenos="3 "></span><span class="nb">export</span><span class="w"> </span><span class="nv">HCAT_HOME</span><span class="o">=</span><span class="nv">$HIVE_HOME</span>/hcatalog
</code></pre></div>
<p>A continuación, preparamos HDFS para crear la estructura de archivos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>hdfs<span class="w"> </span>dfs<span class="w"> </span>-mkdir<span class="w"> </span>/tmp
<span class="linenos" data-linenos="2 "></span>hdfs<span class="w"> </span>dfs<span class="w"> </span>-mkdir<span class="w"> </span>-p<span class="w"> </span>/user/hive/warehouse
<span class="linenos" data-linenos="3 "></span>hdfs<span class="w"> </span>dfs<span class="w"> </span>-chmod<span class="w"> </span>g+w<span class="w"> </span>/tmp
<span class="linenos" data-linenos="4 "></span>hdfs<span class="w"> </span>dfs<span class="w"> </span>-chmod<span class="w"> </span>g+w<span class="w"> </span>/user/hive/warehouse
</code></pre></div>
<p>Para el <em>metastore</em>, como en nuestra máquina virtual tenemos un servidor de <em>MariaDB</em> corriendo, tal como hemos comentado previamente, vamos a reutilizarlo para tener una instalación que permite la conexión de más una sesión de forma simultánea. La mayoría de ejemplos que hay en internet y la diferente bibliografía utilizan <em>DerbyDB</em> como almacén (ya que no requiere una instalación extra, pero solo permiten una única conexión). Así pues, creamos el almacén mediante:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>schematool<span class="w"> </span>-dbType<span class="w"> </span>mysql<span class="w"> </span>-initSchema
</code></pre></div>
<p>Modificamos el fichero de configuración <code>hive-site.xml</code> y configuramos :</p>
<div class="highlight"><span class="filename">hive-site.xml</span><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="cm">&lt;!-- nuevas propiedades --&gt;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="nt">&lt;property&gt;</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">  </span><span class="nt">&lt;name&gt;</span>system:java.io.tmpdir<span class="nt">&lt;/name&gt;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">  </span><span class="nt">&lt;value&gt;</span>/tmp/hive/java<span class="nt">&lt;/value&gt;</span>
<span class="linenos" data-linenos=" 5 "></span><span class="nt">&lt;/property&gt;</span>
<span class="linenos" data-linenos=" 6 "></span><span class="nt">&lt;property&gt;</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">  </span><span class="nt">&lt;name&gt;</span>system:user.name<span class="nt">&lt;/name&gt;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">  </span><span class="nt">&lt;value&gt;</span>${user.name}<span class="nt">&lt;/value&gt;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="nt">&lt;/property&gt;</span>
<span class="linenos" data-linenos="10 "></span><span class="nt">&lt;property&gt;</span>
<span class="linenos" data-linenos="11 "></span><span class="w">  </span><span class="nt">&lt;name&gt;</span>datanucleus.schema.autoCreateAll<span class="nt">&lt;/name&gt;</span>
<span class="linenos" data-linenos="12 "></span><span class="w">  </span><span class="nt">&lt;value&gt;</span>true<span class="nt">&lt;/value&gt;</span>
<span class="linenos" data-linenos="13 "></span><span class="nt">&lt;/property&gt;</span>
<span class="linenos" data-linenos="14 "></span><span class="cm">&lt;!-- propiedades existentes a modificar --&gt;</span>
<span class="linenos" data-linenos="15 "></span><span class="nt">&lt;property&gt;</span>
<span class="linenos" data-linenos="16 "></span><span class="w">  </span><span class="nt">&lt;name&gt;</span>javax.jdo.option.ConnectionURL<span class="nt">&lt;/name&gt;</span>
<span class="linenos" data-linenos="17 "></span><span class="w">  </span><span class="nt">&lt;value&gt;</span>jdbc:mysql://localhost:3306/hive?createDatabaseIfNotExist=true<span class="nt">&lt;/value&gt;</span>
<span class="linenos" data-linenos="18 "></span><span class="nt">&lt;/property&gt;</span>
<span class="linenos" data-linenos="19 "></span><span class="nt">&lt;property&gt;</span>
<span class="linenos" data-linenos="20 "></span><span class="w">  </span><span class="nt">&lt;name&gt;</span>javax.jdo.option.ConnectionDriverName<span class="nt">&lt;/name&gt;</span>
<span class="linenos" data-linenos="21 "></span><span class="w">  </span><span class="nt">&lt;value&gt;</span>com.mysql.jdbc.Driver<span class="nt">&lt;/value&gt;</span>
<span class="linenos" data-linenos="22 "></span><span class="nt">&lt;/property&gt;</span>
<span class="linenos" data-linenos="23 "></span><span class="nt">&lt;property&gt;</span>
<span class="linenos" data-linenos="24 "></span><span class="w">  </span><span class="nt">&lt;name&gt;</span>javax.jdo.option.ConnectionUserName<span class="nt">&lt;/name&gt;</span>
<span class="linenos" data-linenos="25 "></span><span class="w">  </span><span class="nt">&lt;value&gt;</span>iabd<span class="nt">&lt;/value&gt;</span>
<span class="linenos" data-linenos="26 "></span><span class="nt">&lt;/property&gt;</span>
<span class="linenos" data-linenos="27 "></span><span class="nt">&lt;property&gt;</span>
<span class="linenos" data-linenos="28 "></span><span class="w">  </span><span class="nt">&lt;name&gt;</span>javax.jdo.option.ConnectionPassword<span class="nt">&lt;/name&gt;</span>
<span class="linenos" data-linenos="29 "></span><span class="w">  </span><span class="nt">&lt;value&gt;</span>iabd<span class="nt">&lt;/value&gt;</span>
<span class="linenos" data-linenos="30 "></span><span class="nt">&lt;/property&gt;</span>
</code></pre></div>
<h2 id="hola-mundo">Hola Mundo<a class="headerlink" href="#hola-mundo" title="Permanent link">&para;</a></h2>
<p>Si entramos a nuestro <code>$HIVE_HOME</code> podemos comprobar con tenemos las siguientes herramientas:</p>
<ul>
<li><code>hive</code>: Herramienta cliente</li>
<li><code>beeline</code>: Otra herramienta cliente</li>
<li><code>hiserver2</code>: Nos permite arrancar el servidor de Hive</li>
<li><code>schematool</code>: Nos permite trabajar contra la base de datos de metadatos (Metastore)</li>
</ul>
<p>Una vez arrancado <em>Hadoop</em> y <em>YARN</em>, podemos arrancar <em>Hive</em> mediante el cliente local:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>hive
</code></pre></div>
<p>Y una vez dentro, comprobar las bases de datos existentes para ver que todo se configuró correctamente</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">show</span><span class="w"> </span><span class="n">databases</span><span class="p">;</span>
</code></pre></div>
<p>Si quisiéramos ejecutar un script, podemos hacerlo desde el propio comando <code>hive</code> con la opción <code>-f</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>hive<span class="w"> </span>-f<span class="w"> </span>script.sql
</code></pre></div>
<p>Además, tenemos la opción de pasar una consulta desde la propia línea de comandos mediante la opción <code>-e</code>. Supongamos que queremos recuperar los datos de la tabla <code>categories</code> de la base de datos <code>iabd</code> haríamos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>hive<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;select * from iabd.categories&#39;</span>
</code></pre></div>
<h3 id="acceso-remoto">Acceso remoto<a class="headerlink" href="#acceso-remoto" title="Permanent link">&para;</a></h3>
<p><em>HiveServer2</em> (desde Hive 0.11) tiene su propio cliente conocido como <em>Beeline</em>. En entornos reales, el cliente <em>Hive</em> está en desuso a favor de <em>Beeline</em>, por la falta de múltiples usuarios, seguridad y otras características de <em>HiveServer2</em>.</p>
<p>Arrancamos <em>HiveServer2</em> (lo hará en el puerto <code>10000</code>) y <em>Beeline</em> en dos pestañas diferentes mediante los comandos <a href="https://cwiki.apache.org/confluence/display/Hive/Setting+Up+HiveServer2#SettingUpHiveServer2-HowtoStart"><code>hiveserver2</code></a> y <a href="https://cwiki.apache.org/confluence/display/hive/hiveserver2+clients#HiveServer2Clients-Beeline%E2%80%93CommandLineShell"><code>beeline</code></a>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>hiveserver2
</code></pre></div>
<p>Esperamos a que arranque completamente y a continuación:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>beeline
</code></pre></div>
<p>Una vez dentro de <em>Beeline</em>, puede que nos toque volver a unos segundos a que <em>HiveServer2</em> haya arrancando completamente, nos conectamos al servidor:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>!connect jdbc:hive2://iabd-virtualbox:10000
</code></pre></div>
<p>Al conectarnos, tras introducir <code>iabd</code> como usuario y contraseña, obtendremos un interfaz similar al siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Beeline version 3.1.2 by Apache Hive
<span class="linenos" data-linenos="2 "></span>beeline&gt; !connect jdbc:hive2://iabd-virtualbox:10000
<span class="linenos" data-linenos="3 "></span>Connecting to jdbc:hive2://iabd-virtualbox:10000
<span class="linenos" data-linenos="4 "></span>Enter username for jdbc:hive2://iabd-virtualbox:10000: iabd
<span class="linenos" data-linenos="5 "></span>Enter password for jdbc:hive2://iabd-virtualbox:10000: ****
<span class="linenos" data-linenos="6 "></span>Connected to: Apache Hive (version 3.1.2)
<span class="linenos" data-linenos="7 "></span>Driver: Hive JDBC (version 3.1.2)
<span class="linenos" data-linenos="8 "></span>Transaction isolation: TRANSACTION_REPEATABLE_READ
<span class="linenos" data-linenos="9 "></span>0: jdbc:hive2://iabd-virtualbox:10000&gt;
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Beeline y conexión a la vez</p>
<p>Otra forma de trabajar, para arrancar en el mismo proceso <em>Beeline</em> y <em>HiveServer2</em> para pruebas/desarrollo y tener una experiencia similar al cliente <em>Hive</em> accediendo de forma local, podemos ejecutar el siguiente comando donde indicamos tanto el usuario (<code>-n</code>) como la contraseña (<code>-p</code>):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>beeline<span class="w"> </span>-u<span class="w"> </span>jdbc:hive2://iabd-virtualbox:10000<span class="w"> </span>-n<span class="w"> </span>iabd<span class="w"> </span>-p<span class="w"> </span>iabd
</code></pre></div>
</div>
<p>Dentro de <em>Beeline</em>, en cualquier momento podemos ejecutar el comando <code>help</code> que nos mostrará todos los comandos disponibles. Si nos fijamos, además de las comandos del cliente hive, tenemos los comandos <em>beeline</em> que empiezan por el símbolo de exclamación <code>!</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>0: jdbc:hive2://iabd-virtualbox:10000&gt; help
<span class="linenos" data-linenos="2 "></span>!addlocaldriverjar  Add driver jar file in the beeline client side.
<span class="linenos" data-linenos="3 "></span>!addlocaldrivername Add driver name that needs to be supported in the beeline
<span class="linenos" data-linenos="4 "></span>                    client side.
<span class="linenos" data-linenos="5 "></span>!all                Execute the specified SQL against all the current connections
<span class="linenos" data-linenos="6 "></span>!autocommit         Set autocommit mode on or off
<span class="linenos" data-linenos="7 "></span>!batch              Start or execute a batch of statements
<span class="linenos" data-linenos="8 "></span>...
</code></pre></div>
<p>Mediante la interfaz gráfica de <em>Hive Server UI</em> a la cual podemos acceder mediante <a href="http://localhost:10002">http://localhost:10002</a> podemos monitorizar los procesos ejecutados por <em>HiveServer2</em>:</p>
<figure style="align: center;">
    <img src="images/06hive-ui.png" alt="Monitorización mediante Hive Server UI">
    <figcaption>Monitorización mediante Hive Server UI</figcaption>
</figure>

<h2 id="caso-1-creacion-y-borrado-de-tablas">Caso 1: Creación y borrado de tablas<a class="headerlink" href="#caso-1-creacion-y-borrado-de-tablas" title="Permanent link">&para;</a></h2>
<p>Para este caso de uso, vamos a utilizar la base de datos <code>retail_db</code> que ya utilizamos en las actividades de la sesión anterior.</p>
<p>Para empezar, vamos a cargar en HDFS los datos de los clientes que contiene la tabla <code>customer</code>. Mediante <em>Sqoop</em>, ejecutamos el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>sqoop<span class="w"> </span>import<span class="w"> </span>--connect<span class="w"> </span><span class="s2">&quot;jdbc:mysql://localhost/retail_db&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span>--username<span class="w"> </span>iabd<span class="w"> </span>--password<span class="w"> </span>iabd<span class="w"> </span><span class="se">\</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span>--table<span class="w"> </span>customers<span class="w"> </span>--target-dir<span class="w"> </span>/user/iabd/hive/customer<span class="w"> </span><span class="se">\</span>
<span class="linenos" data-linenos="4 "></span><span class="w">  </span>--fields-terminated-by<span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="w"> </span>--delete-target-dir<span class="w"> </span><span class="se">\</span>
<span class="linenos" data-linenos="5 "></span><span class="w">  </span>--columns<span class="w"> </span><span class="s2">&quot;customer_id,customer_fname,customer_lname,customer_city&quot;</span>
</code></pre></div>
<p>Si comprobamos el contenido en HDFS, veremos cómo se han cargado los datos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>hdfs<span class="w"> </span>dfs<span class="w"> </span>-head<span class="w"> </span>/user/iabd/hive/customer/part-m-00000
<span class="linenos" data-linenos="2 "></span><span class="c1"># 1|Richard|Hernandez|Brownsville</span>
<span class="linenos" data-linenos="3 "></span><span class="c1"># 2|Mary|Barrett|Littleton</span>
<span class="linenos" data-linenos="4 "></span><span class="c1"># 3|Ann|Smith|Caguas</span>
<span class="linenos" data-linenos="5 "></span><span class="c1"># 4|Mary|Jones|San Marcos</span>
<span class="linenos" data-linenos="6 "></span>...
</code></pre></div>
<p>A continuación, tras habernos conectado con el cliente <code>hive</code> o mediante <code>beeline</code>, creamos una base de datos llamada <code>iabd</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">create</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">iabd</span><span class="p">;</span>
</code></pre></div>
<p>Nos conectamos a la base de datos que acabamos de crear:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">use</span><span class="w"> </span><span class="n">iabd</span><span class="p">;</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">default</p>
<p>Si olvidamos el comando <code>use</code>, se utilizará la base de datos <code>default</code>, la cual reside en <code>/user/hive/warehouse</code> como raíz en HDFS.</p>
</div>
<p>A continuación, vamos a crear una tabla que almacene el identificador, nombre, apellido y ciudad de los clientes (como puedes observar, la sintaxis es similar a SQL):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customers</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">(</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">  </span><span class="n">custId</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">  </span><span class="n">fName</span><span class="w"> </span><span class="n">STRING</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="ss">&quot;Nombre&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">  </span><span class="n">lName</span><span class="w"> </span><span class="n">STRING</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="ss">&quot;Apellido&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">  </span><span class="n">city</span><span class="w"> </span><span class="n">STRING</span>
<span class="linenos" data-linenos=" 7 "></span><span class="p">)</span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">ROW</span><span class="w"> </span><span class="n">FORMAT</span><span class="w"> </span><span class="n">DELIMITED</span><span class="w">  </span><span class="c1">-- (2)!</span>
<span class="linenos" data-linenos=" 9 "></span><span class="n">FIELDS</span><span class="w"> </span><span class="n">TERMINATED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;|&#39;</span><span class="w">  </span><span class="c1">-- (3)!</span>
<span class="linenos" data-linenos="10 "></span><span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">TEXTFILE</span><span class="w">  </span><span class="c1">-- (4)!</span>
<span class="linenos" data-linenos="11 "></span><span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;/user/iabd/hive/customer&#39;</span><span class="p">;</span><span class="w">  </span><span class="c1">-- (5)!</span>
</code></pre></div>
<ol>
<li>Mediante <code>COMMENT</code> le añadimos un comentario a cada campo</li>
<li>Indica el formato de cada fila como delimitado (con un salto del línea)</li>
<li>Los campos están separados por el carácter <code>|</code> (es el mismo que habíamos indicado en Sqoop)</li>
<li>El contenido está almacenado en HDFS en formato texto</li>
<li>Ruta de HDFS donde se encuentran los datos</li>
</ol>
<p>Y ya podemos realizar algunas consultas:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">select</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Utilizando Hue</p>
<p>Si no queremos conectarnos mediante <em>Beeline</em>, siempre podemos utilizar <em>Hue</em> como un entorno más amigable. Recuerda que para acceder desde la máquina virtual necesitas arrancarlo previamente mediante <code>/opt/hue-4.10.0/build/env/bin/hue runserver</code>.</p>
<p>Una vez dentro, podemos realizar las consultas u operaciones de creación de tablas, etc...</p>
<p><figure style="align: center;">
    <img src="images/06hue-select.png">
    <figcaption>Consultas Hive desde Hue</figcaption>
</figure></p>
</div>
<p>En ocasiones necesitamos almacenar la salida de una consulta <em>Hive</em> en una nueva tabla. Las definiciones de las columnas de la nueva tabla se deriva de las columnas recuperadas en la consulta. Para ello, usaremos el comando <em>create table-as select</em>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customers_new</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</code></pre></div>
<p>En el caso de que la consulta falle por algún motivo, la tabla no se crearía.</p>
<p>Otra posibilidad es crear una tabla con la misma estructura que otra ya existente (pero sin datos):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customers2</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</code></pre></div>
<p>En cualquier momento podemos obtener información de la tabla:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">describe</span><span class="w"> </span><span class="n">customers_new</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">describe</span><span class="w"> </span><span class="n">formatted</span><span class="w"> </span><span class="n">customers_new</span><span class="p">;</span>
</code></pre></div>
<p>Si empleamos la forma larga, obtendremos mucha más información. Por ejemplo, si nos fijamos, vemos que la localización de la nueva tabla ya no es <code>/user/iabd/hive/customer</code> sino <code>hdfs://iabd-virtualbox:9000/user/hive/warehouse/iabd.db/customers_new</code>. Esto se debe a que en vez de crear una tabla enlazada a un recurso de HDFS ya existente, ha creado una copia de los datos en el propio almacén de <em>Hive</em> (hemos pasado de una tabla externa a una interna).</p>
<p>Igual que las creamos, las podemos eliminar:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">customers_new</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">customers2</span><span class="p">;</span>
</code></pre></div>
<p>Si ejecutamos el comando <code>!tables</code> (o <code>show tables</code> en el cliente <code>hive</code>) veremos que ya no aparecen dichas tablas.</p>
<p>En el caso de que queramos eliminar una base de datos, de la misma manera que en SQL, ejecutaríamos el comando <code>drop database iabd</code>. Si nuestra base de datos contiene tablas y las queremos borrar igualmente, entonces necesitamos un borrado en cascada mediante <code>drop database iabd cascade</code>.</p>
<h2 id="caso-2-insertando-datos">Caso 2: Insertando datos<a class="headerlink" href="#caso-2-insertando-datos" title="Permanent link">&para;</a></h2>
<p>Para insertar datos en las tablas de <em>Hive</em> podemos hacerlo de varias formas:</p>
<ul>
<li>Cargando los datos mediante sentencias <code>LOAD DATA</code>.</li>
<li>Insertando los datos mediante sentencias <code>INSERT</code>.</li>
<li>Cargando los datos directamente mediante <em>Sqoop</em> o alguna herramienta similar.</li>
</ul>
<h3 id="cargando-datos">Cargando datos<a class="headerlink" href="#cargando-datos" title="Permanent link">&para;</a></h3>
<p>Para cargar datos se utiliza la sentencia <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-Loadingfilesintotables"><code>LOAD DATA</code></a>. Si quisiéramos volver a cargar los datos desde HDFS utilizaremos:</p>
<div class="admonition warning inline end">
<p class="admonition-title">Datos eliminados</p>
<p>Al cargar los datos mediante <code>LOAD DATA</code> desde HDFS, los datos de origen se eliminan.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">LOAD</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="n">INPATH</span><span class="w"> </span><span class="s1">&#39;/user/iabd/hive/customer&#39;</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="n">overwrite</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</code></pre></div>
<p>Si en cambio vamos a cargar los datos desde un archivo local a nuestro sistema de archivos añadiremos la <em>keyword</em> <code>LOCAL</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">LOAD</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="k">LOCAL</span><span class="w"> </span><span class="n">INPATH</span><span class="w"> </span><span class="s1">&#39;/home/iabd/datos.csv&#39;</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="n">overwrite</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</code></pre></div>
<h3 id="insertando-datos">Insertando datos<a class="headerlink" href="#insertando-datos" title="Permanent link">&para;</a></h3>
<p>Aunque podemos insertar datos de forma atómica (es decir, registro a registro mediante <code>INSERT INTO [TABLE] ... VALUES</code>), realmente las inserciones que se realizan en <em>Hive</em> se hacen a partir de los datos de otras tablas mediante el comando <em>insert-select</em> a modo de ETL:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">destino</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="w"> </span><span class="n">col2</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">fuente</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="n">destino</span>
<span class="linenos" data-linenos="4 "></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="w"> </span><span class="n">col2</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">fuente</span><span class="p">;</span>
</code></pre></div>
<p>Mediante la opción <code>OVERWRITE</code>, en cada ejecución se vacía la tabla y se vuelve a rellenar. Si no lo indicamos o utilizamos <code>INTO</code>, los datos se añadirían a los ya existentes.</p>
<p>Por ejemplo, vamos a crear una nueva tabla de clientes, pero la vamos a almacenar en formato Parquet:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customersp</span>
<span class="linenos" data-linenos="2 "></span><span class="p">(</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="n">custId</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="linenos" data-linenos="4 "></span><span class="w">  </span><span class="n">fName</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<span class="linenos" data-linenos="5 "></span><span class="w">  </span><span class="n">lName</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<span class="linenos" data-linenos="6 "></span><span class="w">  </span><span class="n">city</span><span class="w"> </span><span class="n">STRING</span>
<span class="linenos" data-linenos="7 "></span><span class="p">)</span>
<span class="linenos" data-linenos="8 "></span><span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARQUET</span><span class="p">;</span>
</code></pre></div>
<p>Y a continuación la cargamos con los datos de la tabla <code>customers</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">customersp</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Rendimiento</p>
<p>Prueba a realizar una consulta que cuente la cantidad de clientes en cada una de las tablas ¿Cuál tarda menos? ¿Por qué?</p>
</div>
<p>Si necesitamos insertar datos en múltiples tablas a la vez lo haremos mediante el comando <em>from-insert</em>, ya que ofrece un mejor rendimiento al sólo necesitar un escaneado de los datos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">FROM</span><span class="w"> </span><span class="n">fuente</span>
<span class="linenos" data-linenos="2 "></span><span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">destino1</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="w"> </span><span class="n">col2</span>
<span class="linenos" data-linenos="4 "></span><span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">destino2</span>
<span class="linenos" data-linenos="5 "></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">col1</span><span class="p">,</span><span class="w"> </span><span class="n">col3</span>
</code></pre></div>
<p>Por ejemplo, vamos a crear un par de tablas con la misma estructura de clientes, pero para almacenar los clientes de determinadas ciudades:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customers_brooklyn</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customers_caguas</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</code></pre></div>
<p>Y a continuación rellenamos ambas tablas con sus clientes;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">FROM</span><span class="w"> </span><span class="n">customers</span>
<span class="linenos" data-linenos="2 "></span><span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customers_brooklyn</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">custId</span><span class="p">,</span><span class="w"> </span><span class="n">fName</span><span class="p">,</span><span class="w"> </span><span class="n">lName</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Brooklyn&quot;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">INSERT</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customers_caguas</span>
<span class="linenos" data-linenos="5 "></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">custId</span><span class="p">,</span><span class="w"> </span><span class="n">fName</span><span class="p">,</span><span class="w"> </span><span class="n">lName</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Caguas&quot;</span><span class="p">;</span>
</code></pre></div>
<h3 id="modificando-datos">Modificando datos<a class="headerlink" href="#modificando-datos" title="Permanent link">&para;</a></h3>
<p>Acabamos de añadir datos, y en teoría podemos realizar operaciones <code>UPDATE</code> y <code>DELETE</code> sobre las filas de una tabla.</p>
<p>HDFS no se diseñó pensando en las modificaciones de archivos, con lo que los cambios resultantes de las inserciones, modificaciones y borrados se almacenan en archivos delta. Por cada transacción, se crea un conjunto de archivo delta que altera la tabla (o partición). Los ficheros delta se fusionan periódicamente con los ficheros base de las tablas mediante <em>jobs MapReduce</em> que el metastore ejecuta en <em>background</em>.</p>
<p>Para poder modificar o borrar los datos, Hive necesita trabajar en un contexto transaccional, por lo que necesitamos activar las siguientes variables:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>set hive.support.concurrency=true;
<span class="linenos" data-linenos="2 "></span>set hive.enforce.bucketing=true;
<span class="linenos" data-linenos="3 "></span>set hive.exec.dynamic.partition.mode=nonstrict;
<span class="linenos" data-linenos="4 "></span>set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
</code></pre></div>
<p>Una vez configurado, hemos de crear las tablas con el formato ORC, organizar los datos mediante <em>buckets</em> (los estudiaremos más adelante en esta <a href="hive2.html#buckets">la siguiente sesión</a>) y finalmente indicar mediante <code>TBLPROPERTIES</code> que se trata de una tabla transaccional . Por ejemplo, volvemos a crear la tabla de clientes:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customerstx</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">(</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">  </span><span class="n">custId</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">  </span><span class="n">fName</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">  </span><span class="n">lName</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">  </span><span class="n">city</span><span class="w"> </span><span class="n">STRING</span>
<span class="linenos" data-linenos=" 7 "></span><span class="p">)</span>
<span class="hll"><span class="linenos" data-linenos=" 8 "></span><span class="n">CLUSTERED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">(</span><span class="n">custId</span><span class="p">)</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="n">BUCKETS</span>
</span><span class="hll"><span class="linenos" data-linenos=" 9 "></span><span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ORC</span>
</span><span class="hll"><span class="linenos" data-linenos="10 "></span><span class="n">TBLPROPERTIES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;transactional&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;true&#39;</span><span class="p">);</span>
</span></code></pre></div>
<p>Una vez creada la tabla, la vamos a cargar con los datos de los clientes:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">customerstx</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</code></pre></div>
<p>Un par de minutos después, con los datos datos ya cargados, ya podemos cambiar el nombre de la ciudad <code>Caguas</code> por <code>Elche</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">customerstx</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">city</span><span class="o">=</span><span class="ss">&quot;Elche&quot;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">city</span><span class="o">=</span><span class="ss">&quot;Caguas&quot;</span><span class="p">;</span>
</code></pre></div>
<h3 id="ingestando-datos">Ingestando datos<a class="headerlink" href="#ingestando-datos" title="Permanent link">&para;</a></h3>
<p>Tal como vimos en la <a href="flume.html#trabajando-con-hive">sesión anterior</a>, podemos ingestar los datos en <em>Hive</em> haciendo uso de <em>Sqoop</em> (también lo podemos hacer con <em>Flume</em> o <em>Nifi</em>).</p>
<p>Por ejemplo, vamos a ingestar los datos de la tabla <code>orders</code> de la base de datos <em>MariaDB</em> que tenemos instalada en nuestra máquina virtual. En el comando de <em>Sqoop</em> le indicamos que dentro de <em>Hive</em> lo ingeste en la base de datos <code>iabd</code> y que cree una tabla llamada <code>orders</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>sqoop<span class="w"> </span>import<span class="w"> </span>--connect<span class="w"> </span>jdbc:mysql://localhost/retail_db<span class="w"> </span><span class="se">\</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span>--username<span class="o">=</span>iabd<span class="w"> </span>--password<span class="o">=</span>iabd<span class="w"> </span><span class="se">\</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span>--table<span class="o">=</span>orders<span class="w"> </span>--driver<span class="o">=</span>com.mysql.jdbc.Driver<span class="w"> </span><span class="se">\</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span>--hive-import<span class="w"> </span>--hive-database<span class="w"> </span>iabd<span class="w"> </span><span class="se">\</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span>--create-hive-table<span class="w"> </span>--hive-table<span class="w"> </span>orders
</code></pre></div>
<p>Una vez realizada la ingesta, podemos comprobar que los datos están dentro de <em>Hive</em> (en una tabla interna/gestionada):</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>hdfs<span class="w"> </span>dfs<span class="w"> </span>-ls<span class="w"> </span>/user/hive/warehouse/iabd.db/orders
</code></pre></div>
<p>Y si entramos a <code>hive</code>, podemos consultar sus datos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</code></pre></div>
<h3 id="extrayendo-datos-insertados">Extrayendo datos insertados<a class="headerlink" href="#extrayendo-datos-insertados" title="Permanent link">&para;</a></h3>
<p>Combinando los comandos de HQL y HDFS podemos extraer datos a ficheros locales o remotos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1"># Añadiendo contenido local</span>
<span class="linenos" data-linenos="2 "></span>hive<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;use iabd; select * from customers&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>prueba1
<span class="linenos" data-linenos="3 "></span><span class="c1"># Sobrescribiendo contenido local</span>
<span class="linenos" data-linenos="4 "></span>hive<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;use iabd; select * from customers&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>prueba2
<span class="linenos" data-linenos="5 "></span><span class="c1"># Añadiendo contenido HDFS</span>
<span class="linenos" data-linenos="6 "></span>hive<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;use iabd; select * from customers&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>hdfs<span class="w"> </span>dfs<span class="w"> </span>--appendToFile<span class="w"> </span>/tmp/prueba3
<span class="linenos" data-linenos="7 "></span><span class="c1"># Sobrescribiendo contenido</span>
<span class="linenos" data-linenos="8 "></span>hive<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;use iabd; select * from customers&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>hdfs<span class="w"> </span>dfs<span class="w"> </span>--put<span class="w"> </span>-f<span class="w"> </span>/tmp/prueba4
</code></pre></div>
<p>Si indicamos la propiedad <code>set hive.cli.print.header=true</code> antes de la consulta, también nos mostrará el encabezado de las columnas. Esto puede ser útil si queremos generar un csv con el resultado de una consulta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>hive<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;use iabd; set hive.cli.print.header=true; select * from customers&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span>sed<span class="w"> </span><span class="s1">&#39;s/[\t]/,/g&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>fichero.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">¿Y usar <em>INSERT LOCAL</em>?</p>
<p>Mediante <code>INSERT LOCAL DIRECTORY</code> podemos escribir el resultado de una consulta en nuestro sistema de archivos, fuera de HDFS. El problema es que si hay muchos datos creará múltiples ficheros y necesitaremos concatenarlos para tener un único resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">insert</span><span class="w"> </span><span class="n">overwrite</span><span class="w"> </span><span class="k">local</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="s1">&#39;/home/iabd/datos&#39;</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="k">row</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">delimited</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="n">fields</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="s1">&#39;,&#39;</span>
<span class="linenos" data-linenos="4 "></span><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</code></pre></div>
</div>
<h2 id="caso-3-consultas-con-join">Caso 3: Consultas con <em>join</em><a class="headerlink" href="#caso-3-consultas-con-join" title="Permanent link">&para;</a></h2>
<p>En este caso de uso vamos a trabajar con los datos de clientes y pedidos que hemos cargado en los dos casos anteriores, tanto en <code>customers</code> como en <code>orders</code>.</p>
<p>Si queremos relacionar los datos de ambas tablas, tenemos que hacer un <em>join</em> entre la clave ajena de <code>orders</code> (<code>order_customer_id</code>) y la clave primaria de <code>customers</code> (<code>custid</code>):</p>
<div class="highlight"><pre><span></span><code><span class="hll"><span class="linenos" data-linenos=" 1 "></span><span class="n">hive</span><span class="o">&gt;</span><span class="w"> </span><span class="k">describe</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 2 "></span><span class="n">OK</span>
<span class="linenos" data-linenos=" 3 "></span><span class="n">custid</span><span class="w">                  </span><span class="nb">int</span><span class="w">                                         </span>
<span class="linenos" data-linenos=" 4 "></span><span class="n">fname</span><span class="w">                   </span><span class="n">string</span><span class="w">                                      </span>
<span class="linenos" data-linenos=" 5 "></span><span class="n">lname</span><span class="w">                   </span><span class="n">string</span><span class="w">                                      </span>
<span class="linenos" data-linenos=" 6 "></span><span class="n">city</span><span class="w">                    </span><span class="n">string</span><span class="w">                                      </span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">Time</span><span class="w"> </span><span class="n">taken</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">426</span><span class="w"> </span><span class="n">seconds</span><span class="p">,</span><span class="w"> </span><span class="n">Fetched</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="k">row</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="hll"><span class="linenos" data-linenos=" 8 "></span><span class="n">hive</span><span class="o">&gt;</span><span class="w"> </span><span class="k">describe</span><span class="w"> </span><span class="n">orders</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 9 "></span><span class="n">OK</span>
<span class="linenos" data-linenos="10 "></span><span class="n">order_id</span><span class="w">                </span><span class="nb">int</span><span class="w">                                         </span>
<span class="linenos" data-linenos="11 "></span><span class="n">order_date</span><span class="w">              </span><span class="n">string</span><span class="w">                                      </span>
<span class="linenos" data-linenos="12 "></span><span class="n">order_customer_id</span><span class="w">       </span><span class="nb">int</span><span class="w">                                         </span>
<span class="linenos" data-linenos="13 "></span><span class="n">order_status</span><span class="w">            </span><span class="n">string</span><span class="w">                                      </span>
<span class="linenos" data-linenos="14 "></span><span class="k">Time</span><span class="w"> </span><span class="n">taken</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">276</span><span class="w"> </span><span class="n">seconds</span><span class="p">,</span><span class="w"> </span><span class="n">Fetched</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="k">row</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</code></pre></div>
<p>Para ello, para obtener la ciudad de cada pedido podemos ejecutar la consulta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">order_id</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">order_date</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">city</span>
<span class="linenos" data-linenos="2 "></span><span class="k">from</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">c</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="k">on</span><span class="w"> </span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">order_customer_id</span><span class="o">=</span><span class="k">c</span><span class="p">.</span><span class="n">custid</span><span class="p">);</span>
</code></pre></div>
<h3 id="outer-join">Outer join<a class="headerlink" href="#outer-join" title="Permanent link">&para;</a></h3>
<p>De la misma manera que en cualquier SGBD, podemos realizar un <em>outer join</em>, tanto <em>left</em> como <em>right</em> o <em>full</em>.</p>
<p>Por ejemplo, vamos a obtener para cada cliente, cuantos pedidos ha realizado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">custid</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="k">from</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="n">o</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="k">on</span><span class="w"> </span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">custid</span><span class="o">=</span><span class="n">o</span><span class="p">.</span><span class="n">order_customer_id</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">custid</span>
<span class="linenos" data-linenos="5 "></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">desc</span><span class="p">;</span>
</code></pre></div>
<p>Si queremos que salgan todos los clientes, independientemente de que tengan pedidos, deberemos realizar un <em>left outer join</em>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">custid</span><span class="p">,</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="k">from</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="n">o</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="k">on</span><span class="w"> </span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">custid</span><span class="o">=</span><span class="n">o</span><span class="p">.</span><span class="n">order_customer_id</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">custid</span>
<span class="linenos" data-linenos="5 "></span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span><span class="w"> </span><span class="k">desc</span><span class="p">;</span>
</code></pre></div>
<h3 id="semi-joins">Semi-joins<a class="headerlink" href="#semi-joins" title="Permanent link">&para;</a></h3>
<p>Si quisiéramos obtener las ciudades de los clientes que han realizado pedidos podríamos realizar la siguiente consulta:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">city</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">c</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">custid</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="n">order_customer_id</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">orders</span><span class="p">);</span>
</code></pre></div>
<p>Mediante un semi-join podemos obtener el mismo resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">city</span>
<span class="linenos" data-linenos="2 "></span><span class="k">from</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">c</span>
<span class="linenos" data-linenos="3 "></span><span class="k">left</span><span class="w"> </span><span class="n">semi</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="k">on</span>
<span class="linenos" data-linenos="4 "></span><span class="w">  </span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">custid</span><span class="o">=</span><span class="n">o</span><span class="p">.</span><span class="n">order_customer_id</span><span class="p">)</span>
</code></pre></div>
<p>Hay que tener en cuenta la restricción que las columnas de la tabla de la derecha sólo pueden aparecer en la clausula <code>on</code>, nunca en la expresión <code>select</code>.</p>
<h3 id="map-joins">Map joins<a class="headerlink" href="#map-joins" title="Permanent link">&para;</a></h3>
<p>Consideramos la consulta inicial de join:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">order_id</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">order_date</span><span class="p">,</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">city</span>
<span class="linenos" data-linenos="2 "></span><span class="k">from</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">c</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="k">on</span><span class="w"> </span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">order_customer_id</span><span class="o">=</span><span class="k">c</span><span class="p">.</span><span class="n">custid</span><span class="p">);</span>
</code></pre></div>
<p>Si una tabla es suficientemente pequeña para caber en memoria, tal como nos ocurre con nuestros datos, <em>Hive</em> puede cargarla en memoria para realizar el <em>join</em> en cada uno de los <em>mappers</em>. Esto se conoce como un <strong><em>map join</em></strong>.</p>
<p>El <em>job</em> que ejecuta la consulta no tiene <em>reducers</em>, con lo que esta consulta no funcionará para un <em>right</em> o <em>right outer join</em>, ya que la ausencias de coincidencias sólo se puede detectar en los pasos de agregación (<em>reduce</em>).</p>
<p>En el caso de utilizar <em>map joins</em> con tablas organizadas en <em>buckets</em>, la sintaxis es la misma, sólo siendo necesario activarlo mediante la propiedad <code>hive.optimize.bucketmapjoin</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>SET<span class="w"> </span>hive.optimize.bucketmapjoin<span class="o">=</span>true<span class="p">;</span>
</code></pre></div>
<h2 id="comandos">Comandos<a class="headerlink" href="#comandos" title="Permanent link">&para;</a></h2>
<p>Mediante los casos de uso realizados hasta ahora, hemos podido observar cómo para interactuar con <em>Hive</em> se utilizan comandos similares a SQL.</p>
<p>Es conveniente consultar la siguiente <em>cheatsheet</em>: <a href="http://hortonworks.com/wp-content/uploads/2016/05/Hortonworks.CheatSheet.SQLtoHive.pdf">http://hortonworks.com/wp-content/uploads/2016/05/Hortonworks.CheatSheet.SQLtoHive.pdf</a></p>
<p>Además <em>Hive</em> viene con un conjunto de funciones predefinidas para tratamiento de cadenas, fechas, funciones estadísticas, condicionales, etc... las cuales puedes consultar en la <a href="https://cwiki.apache.org/confluence/display/hive/languagemanual+udf">documentación oficial</a>.</p>
<p>Mediante el comando <code>show functions</code> podemos obtener una lista de las funciones. Si queremos más información sobre una determinada función utilizaremos el comando <code>describe function nombreFuncion</code>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">hive</span><span class="o">&gt;</span><span class="w"> </span><span class="k">describe</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="k">length</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">length</span><span class="p">(</span><span class="n">str</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nb">binary</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">Returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">length</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nb">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nb">binary</span><span class="w"> </span><span class="k">data</span>
</code></pre></div>
<h2 id="caso-4-tabla-interna">Caso 4: Tabla interna<a class="headerlink" href="#caso-4-tabla-interna" title="Permanent link">&para;</a></h2>
<p>Hive permite crear tablas de dos tipos:</p>
<ul>
<li>tabla <strong>interna</strong> o gestionada (<em>managed</em>): gestiona la estructura y el almacenamiento de los datos. Para ello, si no le indicamos lo contrario, crea los datos en HDFS dentro de una carpeta propia, normalmente <code>/user/hive/warehouse</code>. Al borrar la tabla de <em>Hive</em>, se borra la información de HDFS.</li>
<li>tabla <strong>externa</strong>: Hive define la estructura de los datos en el <em>metastore</em>, pero los datos residen HDFS, ya sea que estaban previamente o los vamos a cargar <em>a posteriori</em>. Al borrar la tabla de <em>Hive</em>, no se eliminan los datos de HDFS. Se emplea cuando compartimos datos almacenados en HDFS entre diferentes herramientas.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Ejemplos realizados</p>
<p>Todos los ejemplos realizados hasta ahora, aunque hayamos indicado una ruta externa HDFS mediante la <em>keyword</em> <code>LOCATION</code> son tablas internas. Por tanto, si eliminamos dichas tablas mediante instrucciones <code>DROP TABLE</code>, también eliminaremos los datos en HDFS.</p>
</div>
<p>En este caso de uso, vamos a centrarnos en una tabla interna.</p>
<p>Supongamos el siguiente fichero con datos de empleados:</p>
<div class="highlight"><span class="filename">empleados.txt</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span>Michael|Montreal,Toronto|Male,30|DB:80|Product:DeveloperLead
<span class="linenos" data-linenos="2 "></span>Will|Montreal|Male,35|Perl:85|Product:Lead,Test:Lead
<span class="linenos" data-linenos="3 "></span>Shelley|New York|Female,27|Python:80|Test:Lead,COE:Architect
<span class="linenos" data-linenos="4 "></span>Lucy|Vancouver|Female,57|Sales:89,HR:94|Sales:Lead
</code></pre></div>
<p>Podemos observar como se utiliza <code>|</code> como separador de campos. Analizando los datos, vemos que tenemos los siguientes campos:</p>
<ul>
<li>Nombre</li>
<li>Centros de trabajo (array con las ciudades)</li>
<li>Sexo y edad</li>
<li>Destreza y puntuación</li>
<li>Departamento y cargo</li>
</ul>
<p>Creamos la siguiente tabla interna en <em>Hive</em> mediante el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">empleados_interna</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">(</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="n">string</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">  </span><span class="n">work_place</span><span class="w"> </span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">  </span><span class="n">sex_age</span><span class="w"> </span><span class="n">STRUCT</span><span class="o">&lt;</span><span class="n">sex</span><span class="p">:</span><span class="n">string</span><span class="p">,</span><span class="n">age</span><span class="p">:</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">  </span><span class="n">skills_score</span><span class="w"> </span><span class="k">MAP</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">  </span><span class="n">depart_title</span><span class="w"> </span><span class="k">MAP</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;&gt;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="p">)</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s1">&#39;Esto es una tabla interna&#39;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">ROW</span><span class="w"> </span><span class="n">FORMAT</span><span class="w"> </span><span class="n">DELIMITED</span>
<span class="linenos" data-linenos="10 "></span><span class="n">FIELDS</span><span class="w"> </span><span class="n">TERMINATED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;|&#39;</span>
<span class="linenos" data-linenos="11 "></span><span class="n">COLLECTION</span><span class="w"> </span><span class="n">ITEMS</span><span class="w"> </span><span class="n">TERMINATED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;,&#39;</span>
<span class="linenos" data-linenos="12 "></span><span class="k">MAP</span><span class="w"> </span><span class="n">KEYS</span><span class="w"> </span><span class="n">TERMINATED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="p">;</span>
</code></pre></div>
<p>La sintaxis es muy similar a SQL, destacando las siguientes opciones:</p>
<ul>
<li><code>ROW FORMAT DELIMITED</code>: cada registro ocupa una línea</li>
<li><code>FIELDS TERMINATED BY '|'</code>: define el <code>|</code> como separador de campos</li>
<li><code>COLLECTION ITEMS TERMINATED BY ','</code>: define la coma como separador de los arrays / estructuras</li>
<li><code>MAP KEYS TERMINATED BY ':'</code>: define los dos puntos como separador utilizado en los mapas.</li>
</ul>
<p>Si queremos comprobar la estructura de la tabla mediante el comando <code>show create table empleados_interna</code> veremos las opciones que hemos indicado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="o">+</span><span class="c1">----------------------------------------------------+</span>
<span class="linenos" data-linenos=" 2 "></span><span class="o">|</span><span class="w">                   </span><span class="n">createtab_stmt</span><span class="w">                   </span><span class="o">|</span>
<span class="linenos" data-linenos=" 3 "></span><span class="o">+</span><span class="c1">----------------------------------------------------+</span>
<span class="linenos" data-linenos=" 4 "></span><span class="o">|</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">empleados_interna</span><span class="o">`</span><span class="p">(</span><span class="w">                  </span><span class="o">|</span>
<span class="linenos" data-linenos=" 5 "></span><span class="o">|</span><span class="w">   </span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="w"> </span><span class="n">string</span><span class="p">,</span><span class="w">                                   </span><span class="o">|</span>
<span class="linenos" data-linenos=" 6 "></span><span class="o">|</span><span class="w">   </span><span class="o">`</span><span class="n">work_place</span><span class="o">`</span><span class="w"> </span><span class="nb">array</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">,</span><span class="w">                      </span><span class="o">|</span>
<span class="linenos" data-linenos=" 7 "></span><span class="o">|</span><span class="w">   </span><span class="o">`</span><span class="n">sex_age</span><span class="o">`</span><span class="w"> </span><span class="n">struct</span><span class="o">&lt;</span><span class="n">sex</span><span class="p">:</span><span class="n">string</span><span class="p">,</span><span class="n">age</span><span class="p">:</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span><span class="w">            </span><span class="o">|</span>
<span class="linenos" data-linenos=" 8 "></span><span class="o">|</span><span class="w">   </span><span class="o">`</span><span class="n">skills_score</span><span class="o">`</span><span class="w"> </span><span class="k">map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span><span class="w">                  </span><span class="o">|</span>
<span class="linenos" data-linenos=" 9 "></span><span class="o">|</span><span class="w">   </span><span class="o">`</span><span class="n">depart_title</span><span class="o">`</span><span class="w"> </span><span class="k">map</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span><span class="nb">array</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;&gt;</span><span class="p">)</span><span class="w">        </span><span class="o">|</span>
<span class="linenos" data-linenos="10 "></span><span class="o">|</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="s1">&#39;Esto es una tabla interna&#39;</span><span class="w">                </span><span class="o">|</span>
<span class="linenos" data-linenos="11 "></span><span class="o">|</span><span class="w"> </span><span class="k">ROW</span><span class="w"> </span><span class="n">FORMAT</span><span class="w"> </span><span class="n">SERDE</span><span class="w">                                   </span><span class="o">|</span>
<span class="linenos" data-linenos="12 "></span><span class="o">|</span><span class="w">   </span><span class="s1">&#39;org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe&#39;</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="13 "></span><span class="o">|</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">SERDEPROPERTIES</span><span class="w"> </span><span class="p">(</span><span class="w">                             </span><span class="o">|</span>
<span class="linenos" data-linenos="14 "></span><span class="o">|</span><span class="w">   </span><span class="s1">&#39;collection.delim&#39;</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="w">                          </span><span class="o">|</span>
<span class="linenos" data-linenos="15 "></span><span class="o">|</span><span class="w">   </span><span class="s1">&#39;field.delim&#39;</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">,</span><span class="w">                               </span><span class="o">|</span>
<span class="linenos" data-linenos="16 "></span><span class="o">|</span><span class="w">   </span><span class="s1">&#39;mapkey.delim&#39;</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="w">                              </span><span class="o">|</span>
<span class="linenos" data-linenos="17 "></span><span class="o">|</span><span class="w">   </span><span class="s1">&#39;serialization.format&#39;</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">)</span><span class="w">                      </span><span class="o">|</span>
<span class="linenos" data-linenos="18 "></span><span class="o">|</span><span class="w"> </span><span class="n">STORED</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">INPUTFORMAT</span><span class="w">                              </span><span class="o">|</span>
<span class="linenos" data-linenos="19 "></span><span class="o">|</span><span class="w">   </span><span class="s1">&#39;org.apache.hadoop.mapred.TextInputFormat&#39;</span><span class="w">       </span><span class="o">|</span>
<span class="linenos" data-linenos="20 "></span><span class="o">|</span><span class="w"> </span><span class="n">OUTPUTFORMAT</span><span class="w">                                       </span><span class="o">|</span>
<span class="linenos" data-linenos="21 "></span><span class="o">|</span><span class="w">   </span><span class="s1">&#39;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#39;</span><span class="w"> </span><span class="o">|</span>
<span class="linenos" data-linenos="22 "></span><span class="o">|</span><span class="w"> </span><span class="k">LOCATION</span><span class="w">                                           </span><span class="o">|</span>
<span class="linenos" data-linenos="23 "></span><span class="o">|</span><span class="w">   </span><span class="s1">&#39;hdfs://iabd-virtualbox:9000/user/hive/warehouse/iabd.db/empleados_interna&#39;</span><span class="w"> </span><span class="o">|</span>
<span class="linenos" data-linenos="24 "></span><span class="o">|</span><span class="w"> </span><span class="n">TBLPROPERTIES</span><span class="w"> </span><span class="p">(</span><span class="w">                                    </span><span class="o">|</span>
<span class="linenos" data-linenos="25 "></span><span class="o">|</span><span class="w">   </span><span class="s1">&#39;bucketing_version&#39;</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w">                         </span><span class="o">|</span>
<span class="linenos" data-linenos="26 "></span><span class="o">|</span><span class="w">   </span><span class="s1">&#39;transient_lastDdlTime&#39;</span><span class="o">=</span><span class="s1">&#39;1647432129&#39;</span><span class="p">)</span><span class="w">            </span><span class="o">|</span>
<span class="linenos" data-linenos="27 "></span><span class="o">+</span><span class="c1">----------------------------------------------------+</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Formato de las tablas</p>
<p>Si queremos indicarle el <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-StorageFormatsStorageFormatsRowFormat,StorageFormat,andSerDe">formato a las tablas</a>, mediante <code>STORED AS</code> podemos indicar formatos:</p>
<ul>
<li>basados en filas, como <code>TEXTFILE</code>, <code>JSONFILE</code>, <code>AVRO</code> o en formato de secuencia mediante <code>SEQUENCEFILE</code>.</li>
<li>basados en columnas, como <code>PARQUET</code> o <code>ORC</code>.</li>
</ul>
</div>
<p>A continuación, vamos a cargar los datos del fichero <a href="resources/empleados.txt">empleados.txt</a>, el cual colocaremos en nuestra carpeta de <em>Descargas</em>:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">LOAD</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="k">LOCAL</span><span class="w"> </span><span class="n">INPATH</span><span class="w"> </span><span class="s1">&#39;/home/iabd/Descargas/empleados.txt&#39;</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Comprobamos que los datos se han cargado correctamente:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Y obtenemos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="go">+-------------------------+-------------------------------+----------------------------+---------------------------------+----------------------------------------+</span>
<span class="linenos" data-linenos="2 "></span><span class="go">| empleados_interna.name  | empleados_interna.work_place  | empleados_interna.sex_age  | empleados_interna.skills_score  |     empleados_interna.depart_title     |</span>
<span class="linenos" data-linenos="3 "></span><span class="go">+-------------------------+-------------------------------+----------------------------+---------------------------------+----------------------------------------+</span>
<span class="linenos" data-linenos="4 "></span><span class="go">| Michael                 | [&quot;Montreal&quot;,&quot;Toronto&quot;]        | {&quot;sex&quot;:&quot;Male&quot;,&quot;age&quot;:30}    | {&quot;DB&quot;:80}                       | {&quot;Product&quot;:[&quot;Developer&quot;,&quot;Lead&quot;]}       |</span>
<span class="linenos" data-linenos="5 "></span><span class="go">| Will                    | [&quot;Montreal&quot;]                  | {&quot;sex&quot;:&quot;Male&quot;,&quot;age&quot;:35}    | {&quot;Perl&quot;:85}                     | {&quot;Product&quot;:[&quot;Lead&quot;],&quot;Test&quot;:[&quot;Lead&quot;]}   |</span>
<span class="linenos" data-linenos="6 "></span><span class="go">| Shelley                 | [&quot;New York&quot;]                  | {&quot;sex&quot;:&quot;Female&quot;,&quot;age&quot;:27}  | {&quot;Python&quot;:80}                   | {&quot;Test&quot;:[&quot;Lead&quot;],&quot;COE&quot;:[&quot;Architect&quot;]}  |</span>
<span class="linenos" data-linenos="7 "></span><span class="go">| Lucy                    | [&quot;Vancouver&quot;]                 | {&quot;sex&quot;:&quot;Female&quot;,&quot;age&quot;:57}  | {&quot;Sales&quot;:89,&quot;HR&quot;:94}            | {&quot;Sales&quot;:[&quot;Lead&quot;]}                     |</span>
<span class="linenos" data-linenos="8 "></span><span class="go">+-------------------------+-------------------------------+----------------------------+---------------------------------+----------------------------------------+</span>
</code></pre></div>
<p>Y si nos abrimos otra pestaña, mediante HDFS, comprobamos que tenemos los datos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>hdfs<span class="w"> </span>dfs<span class="w"> </span>-ls<span class="w"> </span>/user/hive/warehouse/curso.db/empleados_interna
<span class="linenos" data-linenos="2 "></span>hdfs<span class="w"> </span>dfs<span class="w"> </span>-cat<span class="w"> </span>/user/hive/warehouse/curso.db/empleados_interna/empleados.txt
</code></pre></div>
<p>Y obtenemos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="go">Michael|Montreal,Toronto|Male,30|DB:80|Product:DeveloperLead</span>
<span class="linenos" data-linenos="2 "></span><span class="go">Will|Montreal|Male,35|Perl:85|Product:Lead,Test:Lead</span>
<span class="linenos" data-linenos="3 "></span><span class="go">Shelley|New York|Female,27|Python:80|Test:Lead,COE:Architect</span>
<span class="linenos" data-linenos="4 "></span><span class="go">Lucy|Vancouver|Female,57|Sales:89,HR:94|Sales:Lead</span>
</code></pre></div>
<h3 id="consultando-datos-compuestos">Consultando datos compuestos<a class="headerlink" href="#consultando-datos-compuestos" title="Permanent link">&para;</a></h3>
<p>Si nos fijamos bien en la tabla, tenemos tres columnas con diferentes datos compuestos.</p>
<ul>
<li><code>work_place</code>, con un <code>ARRAY&lt;string&gt;</code></li>
<li><code>sex_age</code> con una <code>STRUCT&lt;sex:string,age:int&gt;</code></li>
<li><code>skills_score</code> con un <code>MAP&lt;string,int&gt;</code>,</li>
<li><code>depart_title</code> con un <code>MAP&lt;STRING,ARRAY&lt;STRING&gt;&gt;</code></li>
</ul>
<p>Si queremos obtener los datos del <strong>array</strong>, podemos realizar las siguientes consultas:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Todos los elementos</label><label for="__tabbed_1_2">Elementos individuales</label><label for="__tabbed_1_3">Cantidad de elementos</label><label for="__tabbed_1_4">Explode array</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Todos los lugares de trabajo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">work_place</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+----------+-------------------------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">   </span><span class="nx">name</span><span class="w">   </span><span class="o">|</span><span class="w">       </span><span class="nx">work_place</span><span class="w">        </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+----------+-------------------------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Michael</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Montreal&quot;</span><span class="p">,</span><span class="s2">&quot;Toronto&quot;</span><span class="p">]</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Will</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Montreal&quot;</span><span class="p">]</span><span class="w">            </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Shelley</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;New York&quot;</span><span class="p">]</span><span class="w">            </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Lucy</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Vancouver&quot;</span><span class="p">]</span><span class="w">           </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+----------+-------------------------+</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Utilizamos la notación de array para mostrar los dos primeros puestos de trabajo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">work_place</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lugar1</span><span class="p">,</span><span class="w"> </span><span class="n">work_place</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lugar2</span>
<span class="linenos" data-linenos="2 "></span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+------------+----------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">   </span><span class="nx">lugar1</span><span class="w">   </span><span class="o">|</span><span class="w">  </span><span class="nx">lugar2</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+------------+----------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Montreal</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="nx">Toronto</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Montreal</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">     </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="nx">New</span><span class="w"> </span><span class="nx">York</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">     </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Vancouver</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">     </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+------------+----------+</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Mediante la función <code>size</code> obtenemos la cantidad de lugares de trabajo:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="k">size</span><span class="p">(</span><span class="n">work_place</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">cantLugares</span>
<span class="linenos" data-linenos="2 "></span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+--------------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w"> </span><span class="nx">cantlugares</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+--------------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="mf">2</span><span class="w">            </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="mf">1</span><span class="w">            </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="mf">1</span><span class="w">            </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="mf">1</span><span class="w">            </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+--------------+</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Para obtener los empleados y lugares de trabajo mostrados uno por fila, hemos de realizar un <em>explode</em> sobre el array:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">lugar</span>
<span class="linenos" data-linenos="2 "></span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span>
<span class="linenos" data-linenos="3 "></span><span class="k">lateral</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="n">explode</span><span class="w"> </span><span class="p">(</span><span class="n">work_place</span><span class="p">)</span><span class="w"> </span><span class="n">e2</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lugar</span><span class="p">;</span>
</code></pre></div>
<p>Para ello hemos creado una vista lateral y con la función <code>explode</code> <em>desenrollamos</em> el array. Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+----------+------------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">   </span><span class="nx">name</span><span class="w">   </span><span class="o">|</span><span class="w">   </span><span class="nx">lugar</span><span class="w">    </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+----------+------------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Michael</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">Montreal</span><span class="w">   </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Michael</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">Toronto</span><span class="w">    </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Will</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="nx">Montreal</span><span class="w">   </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Shelley</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">New</span><span class="w"> </span><span class="nx">York</span><span class="w">   </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Lucy</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="nx">Vancouver</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="9 "></span><span class="o">+----------+------------+</span>
</code></pre></div>
</div>
</div>
</div>
<p>En el caso de la <strong>estructura</strong> con el sexo y la edad podemos realizar las siguientes consultas</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Todos los elementos</label><label for="__tabbed_2_2">Elementos individuales</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Todas las estructuras de sexo/edad:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">sex_age</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+----------------------------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">          </span><span class="nx">sex_age</span><span class="w">           </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+----------------------------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;sex&quot;</span><span class="o">:</span><span class="s2">&quot;Male&quot;</span><span class="p">,</span><span class="s2">&quot;age&quot;</span><span class="o">:</span><span class="mf">30</span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;sex&quot;</span><span class="o">:</span><span class="s2">&quot;Male&quot;</span><span class="p">,</span><span class="s2">&quot;age&quot;</span><span class="o">:</span><span class="mf">35</span><span class="p">}</span><span class="w">    </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;sex&quot;</span><span class="o">:</span><span class="s2">&quot;Female&quot;</span><span class="p">,</span><span class="s2">&quot;age&quot;</span><span class="o">:</span><span class="mf">27</span><span class="p">}</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;sex&quot;</span><span class="o">:</span><span class="s2">&quot;Female&quot;</span><span class="p">,</span><span class="s2">&quot;age&quot;</span><span class="o">:</span><span class="mf">57</span><span class="p">}</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+----------------------------+</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Utilizando la notación <code>.</code> podemos obtener el sexo y edad por separado</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">sex_age</span><span class="p">.</span><span class="n">sex</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sexo</span><span class="p">,</span><span class="w"> </span><span class="n">sex_age</span><span class="p">.</span><span class="n">age</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">edad</span>
<span class="linenos" data-linenos="2 "></span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+---------+-------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">  </span><span class="nx">sexo</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="nx">edad</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+---------+-------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Male</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mf">30</span><span class="w">    </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Male</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mf">35</span><span class="w">    </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Female</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mf">27</span><span class="w">    </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Female</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mf">57</span><span class="w">    </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+---------+-------+</span>
</code></pre></div>
</div>
</div>
</div>
<p>Respecto al <strong>mapa</strong> con las habilidades y sus puntuaciones:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Todos los elementos</label><label for="__tabbed_3_2">Elementos individuales</label><label for="__tabbed_3_3">Claves y valores</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Todas las habilidades como un mapa:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">skills_score</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+-----------------------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">     </span><span class="nx">skills_score</span><span class="w">      </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+-----------------------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;DB&quot;</span><span class="o">:</span><span class="mf">80</span><span class="p">}</span><span class="w">             </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;Perl&quot;</span><span class="o">:</span><span class="mf">85</span><span class="p">}</span><span class="w">           </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;Python&quot;</span><span class="o">:</span><span class="mf">80</span><span class="p">}</span><span class="w">         </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;Sales&quot;</span><span class="o">:</span><span class="mf">89</span><span class="p">,</span><span class="s2">&quot;HR&quot;</span><span class="o">:</span><span class="mf">94</span><span class="p">}</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+-----------------------+</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Utilizando la notación array con claves, obtenemos el nombre y puntuación de las habilidades:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">skills_score</span><span class="p">[</span><span class="ss">&quot;DB&quot;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">db</span><span class="p">,</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="n">skills_score</span><span class="p">[</span><span class="ss">&quot;Perl&quot;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">perl</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="n">skills_score</span><span class="p">[</span><span class="ss">&quot;Python&quot;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">python</span><span class="p">,</span>
<span class="linenos" data-linenos="4 "></span><span class="w">  </span><span class="n">skills_score</span><span class="p">[</span><span class="ss">&quot;Sales&quot;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">ventas</span><span class="p">,</span>
<span class="linenos" data-linenos="5 "></span><span class="w">  </span><span class="n">skills_score</span><span class="p">[</span><span class="ss">&quot;HR&quot;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">hr</span>
<span class="linenos" data-linenos="6 "></span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+----------+-------+-------+---------+---------+-------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">   </span><span class="nx">name</span><span class="w">   </span><span class="o">|</span><span class="w">  </span><span class="nx">db</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="nx">perl</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">python</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">ventas</span><span class="w">  </span><span class="o">|</span><span class="w">  </span><span class="nx">hr</span><span class="w">   </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+----------+-------+-------+---------+---------+-------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Michael</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mf">80</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Will</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mf">85</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Shelley</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="mf">80</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Lucy</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="mf">89</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="mf">94</span><span class="w">    </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+----------+-------+-------+---------+---------+-------+</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Claves y valores de las habilidades:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">map_keys</span><span class="p">(</span><span class="n">skills_score</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">claves</span><span class="p">,</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="n">map_values</span><span class="p">(</span><span class="n">skills_score</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">valores</span>
<span class="linenos" data-linenos="3 "></span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+----------+-----------------+----------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">   </span><span class="nx">name</span><span class="w">   </span><span class="o">|</span><span class="w">     </span><span class="nx">claves</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="nx">valores</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+----------+-----------------+----------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Michael</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;DB&quot;</span><span class="p">]</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="mf">80</span><span class="p">]</span><span class="w">     </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Will</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Perl&quot;</span><span class="p">]</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="mf">85</span><span class="p">]</span><span class="w">     </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Shelley</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Python&quot;</span><span class="p">]</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="mf">80</span><span class="p">]</span><span class="w">     </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Lucy</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span><span class="s2">&quot;HR&quot;</span><span class="p">]</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="mf">89</span><span class="p">,</span><span class="mf">94</span><span class="p">]</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+----------+-----------------+----------+</span>
</code></pre></div>
</div>
</div>
</div>
<p>Y finalmente, con el mapa de departamentos que contiene un array:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Todos los elementos</label><label for="__tabbed_4_2">Elementos individuales</label><label for="__tabbed_4_3">Primer elemento de los elementos individuales</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Toda la información sobre los departamentos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">depart_title</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+----------------------------------------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">              </span><span class="nx">depart_title</span><span class="w">              </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+----------------------------------------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;Product&quot;</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;Developer&quot;</span><span class="p">,</span><span class="s2">&quot;Lead&quot;</span><span class="p">]}</span><span class="w">       </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;Product&quot;</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;Lead&quot;</span><span class="p">],</span><span class="s2">&quot;Test&quot;</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;Lead&quot;</span><span class="p">]}</span><span class="w">   </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;Test&quot;</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;Lead&quot;</span><span class="p">],</span><span class="s2">&quot;COE&quot;</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;Architect&quot;</span><span class="p">]}</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;Sales&quot;</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;Lead&quot;</span><span class="p">]}</span><span class="w">                     </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+----------------------------------------+</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Nombre y puntuación de las habilidades:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">depart_title</span><span class="p">[</span><span class="ss">&quot;Product&quot;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product</span><span class="p">,</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="n">depart_title</span><span class="p">[</span><span class="ss">&quot;Test&quot;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">test</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="n">depart_title</span><span class="p">[</span><span class="ss">&quot;COE&quot;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">coe</span><span class="p">,</span>
<span class="linenos" data-linenos="4 "></span><span class="w">  </span><span class="n">depart_title</span><span class="p">[</span><span class="ss">&quot;Sales&quot;</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sales</span>
<span class="linenos" data-linenos="5 "></span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+----------+-----------------------+-----------+----------------+-----------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">   </span><span class="nx">name</span><span class="w">   </span><span class="o">|</span><span class="w">        </span><span class="nx">product</span><span class="w">        </span><span class="o">|</span><span class="w">   </span><span class="nx">test</span><span class="w">    </span><span class="o">|</span><span class="w">      </span><span class="nx">coe</span><span class="w">       </span><span class="o">|</span><span class="w">   </span><span class="nx">sales</span><span class="w">   </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+----------+-----------------------+-----------+----------------+-----------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Michael</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Developer&quot;</span><span class="p">,</span><span class="s2">&quot;Lead&quot;</span><span class="p">]</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">      </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Will</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Lead&quot;</span><span class="p">]</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Lead&quot;</span><span class="p">]</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">      </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Shelley</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">                  </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Lead&quot;</span><span class="p">]</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Architect&quot;</span><span class="p">]</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">      </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Lucy</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">                  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Lead&quot;</span><span class="p">]</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+----------+-----------------------+-----------+----------------+-----------+</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Primera habilidad de producto y pruebas de cada empleado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">depart_title</span><span class="p">[</span><span class="ss">&quot;Product&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">product0</span><span class="p">,</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="n">depart_title</span><span class="p">[</span><span class="ss">&quot;Test&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">test0</span>
<span class="linenos" data-linenos="3 "></span><span class="k">from</span><span class="w"> </span><span class="n">empleados_interna</span><span class="p">;</span>
</code></pre></div>
<p>Resultado:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="o">+----------+-------------+--------+</span>
<span class="linenos" data-linenos="2 "></span><span class="o">|</span><span class="w">   </span><span class="nx">name</span><span class="w">   </span><span class="o">|</span><span class="w">  </span><span class="nx">product0</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="nx">test0</span><span class="w">  </span><span class="o">|</span>
<span class="linenos" data-linenos="3 "></span><span class="o">+----------+-------------+--------+</span>
<span class="linenos" data-linenos="4 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Michael</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">Developer</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">   </span><span class="o">|</span>
<span class="linenos" data-linenos="5 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Will</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="nx">Lead</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="nx">Lead</span><span class="w">   </span><span class="o">|</span>
<span class="linenos" data-linenos="6 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Shelley</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="nx">Lead</span><span class="w">   </span><span class="o">|</span>
<span class="linenos" data-linenos="7 "></span><span class="o">|</span><span class="w"> </span><span class="nx">Lucy</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="nx">NULL</span><span class="w">   </span><span class="o">|</span>
<span class="linenos" data-linenos="8 "></span><span class="o">+----------+-------------+--------+</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="caso-5-tabla-externa">Caso 5: Tabla externa<a class="headerlink" href="#caso-5-tabla-externa" title="Permanent link">&para;</a></h2>
<p>En este caso de uso vamos a repetir la misma estructura de la tabla del caso anterior, pero en esta ocasión en una tabla externa. De esta manera, al borrar la tabla de <em>Hive</em>, <strong>no</strong> se borra la información de HDFS.</p>
<p>Para ello, únicamente hemos de añadir la palabra <strong><code>EXTERNAL</code></strong> a la instrucción <code>CREATE TABLE</code> <strong>y</strong> la clausula <strong><code>LOCATION</code></strong> para indicar la ruta de HDFS donde se encuentran los datos:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">EXTERNAL</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">empleados_externa</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">(</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="n">string</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">  </span><span class="n">work_place</span><span class="w"> </span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">  </span><span class="n">sex_age</span><span class="w"> </span><span class="n">STRUCT</span><span class="o">&lt;</span><span class="n">sex</span><span class="p">:</span><span class="n">string</span><span class="p">,</span><span class="n">age</span><span class="p">:</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">  </span><span class="n">skills_score</span><span class="w"> </span><span class="k">MAP</span><span class="o">&lt;</span><span class="n">string</span><span class="p">,</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">  </span><span class="n">depart_title</span><span class="w"> </span><span class="k">MAP</span><span class="o">&lt;</span><span class="n">STRING</span><span class="p">,</span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">STRING</span><span class="o">&gt;&gt;</span>
<span class="linenos" data-linenos=" 8 "></span><span class="p">)</span><span class="w"> </span><span class="k">COMMENT</span><span class="w"> </span><span class="ss">&quot;Esto es una tabla externa&quot;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">ROW</span><span class="w"> </span><span class="n">FORMAT</span><span class="w"> </span><span class="n">DELIMITED</span>
<span class="linenos" data-linenos="10 "></span><span class="n">FIELDS</span><span class="w"> </span><span class="n">TERMINATED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;|&#39;</span>
<span class="linenos" data-linenos="11 "></span><span class="n">COLLECTION</span><span class="w"> </span><span class="n">ITEMS</span><span class="w"> </span><span class="n">TERMINATED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;,&#39;</span>
<span class="linenos" data-linenos="12 "></span><span class="k">MAP</span><span class="w"> </span><span class="n">KEYS</span><span class="w"> </span><span class="n">TERMINATED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;:&#39;</span>
<span class="linenos" data-linenos="13 "></span><span class="k">LOCATION</span><span class="w"> </span><span class="ss">&quot;/user/iabd/hive/empleados_externa&quot;</span><span class="p">;</span>
</code></pre></div>
<p>Realizamos la misma carga que en el caso anterior:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">LOAD</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="k">LOCAL</span><span class="w"> </span><span class="n">INPATH</span><span class="w"> </span><span class="s1">&#39;/home/iabd/Descargas/empleados.txt&#39;</span><span class="w"> </span><span class="n">OVERWRITE</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">empleados_externa</span><span class="p">;</span>
</code></pre></div>
<p>Si hacemos una consulta sobre la tabla para ver que están todos los campos obtendremos la misma información que antes:</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">empleados_externa</span><span class="p">;</span>
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Interna o externa</p>
<p>Como normal general, si todo nuestro procesamiento lo hacemos mediante <em>Hive</em>, es más cómodo utilizar tablas internas. Si no es así, y otras herramientas acceden al mismo dataset, es mejor utilizar tablas externas.</p>
<p>Un patrón de uso muy común es utilizar una tabla externa para acceder al dataset inicial almacenado en HDFS (creado por otro proceso), y posteriormente crear una transformación en <em>Hive</em> para mover los datos a una tabla interna.</p>
</div>
<!--
Las tablas externas dan pie al uso de consultas federadas ... AMPLIAR
-->

<!--

### Consultas agregadas

Para ordenar los datos podemos utilizar la clausula `order by`, la cual realiza un ordenación del resultado final. Cuando no necesitamos ordenar todo el resultado, podemos usar la extensión de *Hive* `sort by`, que realiza la ordenación a nivel de *reducer*.

Para controlar que *reducer* se aplica a una determinada fila (normalmente para realizar algún tipo de agregación), hemos de utilizar la clausula de Hive `distribute by`.

<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">SELECT</span><span class="w"> </span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">temperature</span>
<span class="linenos" data-linenos="2 "></span><span class="k">FROM</span><span class="w"> </span><span class="n">weather</span>
<span class="linenos" data-linenos="3 "></span><span class="n">DISTRIBUTE</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">year</span>
<span class="linenos" data-linenos="4 "></span><span class="n">SORT</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">year</span><span class="w"> </span><span class="k">ASC</span><span class="p">,</span><span class="w"> </span><span class="n">temperature</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre></div>

Si las columnas de `sort by` y `distribute by` son las mismas, podemos utilizar `cluster by` como un atajo para indicar ambas.
-->

<h2 id="referencias">Referencias<a class="headerlink" href="#referencias" title="Permanent link">&para;</a></h2>
<ul>
<li>Página oficial de <a href="https://hive.apache.org">Hive</a></li>
<li><a href="https://www.packtpub.com/product/apache-hive-essentials-second-edition/9781788995092">Apache Hive Essentials - Second Edition</a> de <em>Dayong Du</em>.</li>
<li><a href="http://hortonworks.com/wp-content/uploads/2016/05/Hortonworks.CheatSheet.SQLtoHive.pdf">Hive Cheatsheet</a></li>
<li><a href="https://www.tutorialspoint.com/hive/index.htm">Tutorial de Hive</a> de TutorialsPoint.</li>
</ul>
<h2 id="actividades">Actividades<a class="headerlink" href="#actividades" title="Permanent link">&para;</a></h2>
<p>(<abbr title="Gestiona y almacena datos facilitando la búsqueda de respuestas en grandes conjuntos de datos.">RASBD.3</abbr> / <abbr title="Se ha fijado el objetivo de extraer valor de los datos para lo que es necesario contar con tecnologías eficientes.">CESBD.3b</abbr> y <abbr title="Se han desarrollado sistemas de gestión, almacenamiento y procesamiento de grandes volúmenes de datos de manera eficiente y segura, teniendo en cuenta la normativa existente.">CESBD.3d</abbr>) A partir de los archivos trabajados en la sesión sobre <a href="../de/pentaho.html">Pentaho</a>, vamos a crear diversas tablas y consultas en <em>Hive</em>. Para las siguientes actividades, se pide adjuntar tanto los scripts como comandos empleados, así como una captura de pantalla donde se vea la ejecución de las diferentes instrucciones.</p>
<ol>
<li>Carga los archivos <a href="../de/resources/pdi_sales.csv"><code>pdi_sales</code></a>, <a href="../de/resources/pdi_product.csv"><code>pdi_product</code></a> y <a href="../de/resources/pdi_manufacturer.csv"><code>pdi_manufacturer</code></a> en HDFS en las rutas <code>/user/iabd/pdi/sales</code>, <code>/user/iabd/pdi/product</code> y <code>/user/iabd/pdi/manufacturer</code> respectivamente.</li>
<li>Crea la base de datos <code>hiveiabd</code> sobre la cual realizaremos los siguientes pasos.</li>
<li>
<p>(1p) Crea una tabla externa para cada uno de los archivos y llámalas <code>sales</code>, <code>product</code> y <code>manufacturer</code> respectivamente con formato de <code>TEXTFILE</code> teniendo en cuenta los separadores empleados en cada archivo (unos utilizan el punto y coma <code>;</code> y otros la coma <code>,</code>), la ruta de HDFS que hemos creado anteriormente y los tipos de datos necesarios (por simplicidad, el campo con la fecha de la venta gestiónala como <code>STRING</code> y renombra el campo, ya que <code>Date</code> es una palabra clave y no puede ser el nombre de una columna). Finalmente, realiza una consulta sobre cada tabla para comprobar que contiene los datos esperados.</p>
<p>Para que no coja la primera línea que contiene el nombre de las columnas, añade la propiedad <code>skip.header.line.count</code> en la creación de cada tabla;</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="p">...</span>
<span class="linenos" data-linenos="2 "></span><span class="p">...</span>
<span class="linenos" data-linenos="3 "></span><span class="n">TBLPROPERTIES</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;skip.header.line.count&quot;</span><span class="o">=</span><span class="ss">&quot;1&quot;</span><span class="p">);</span>
</code></pre></div>
</li>
<li>
<p>(1.5p) Crea una tabla transaccional llamada <code>productx</code> en formato ORC con la misma estructura que la tabla de <code>product</code>.</p>
<ol>
<li>Cárgala con los datos de la tabla <code>product</code> y comprueba cuantos registros tiene.</li>
<li>Elimina todos los registros de la tabla <code>productx</code> cuya categoría sea <code>Mix</code> y comprueba cuanto registros tiene ahora.</li>
<li>Recupera todos los registros de la tabla <code>productx</code> de la categoría <code>Urban</code> y guarda el resultado en HDFS en la carpeta <code>/user/iabd/pdi/productx</code> utilizando la coma como separador de campos.</li>
<li>¿En qué ruta de HDFS se almacenan los datos de las tablas internas? ¿Y en concreto de la tabla <code>productx</code>? ¿Cómo lo has averiguado?</li>
</ol>
</li>
<li>(0.5p) Crea una tabla interna llamada <code>productos</code> con formato <em>Parquet</em> que contengan todas las columnas de las tablas <code>product</code> y <code>manufacturer</code> (sin repetidos) y rellénala con el resultado de realizar un <em>join</em> entre las tablas <code>product</code> y <code>manufacturer</code>.</li>
<li>(1p) Crea una tabla externa llamada <code>productext</code> con la misma estructura que la tabla <code>product</code> pero cuyos datos referencien <code>/user/iabd/pdi/productext</code>.<ol>
<li>Ejecuta una consulta y comprueba que la tabla está vacía.</li>
<li>Copia el archivo de <code>/user/iabd/pdi/productx</code> a <code>/user/iabd/pdi/productext</code> y vuelve a realizar la consulta.</li>
<li>Elimina la tabla <code>productext</code> y comprueba si los datos siguen estando en HDFS en <code>/user/iabd/pdi/productext</code>.</li>
</ol>
</li>
</ol>
<!--
<https://www.analyticsvidhya.com/blog/2020/10/getting-started-with-apache-hive/>

<https://www.analyticsvidhya.com/blog/2021/05/hive-a-data-warehouse-in-hadoop-framework/>

2223
  Formato de las tablas: parquet, fixed file format
  Alter table -> https://cwiki.apache.org/confluence/display/Hive/Tutorial#Tutorial-LoadingData

  tablesample
  Transformación map/reduce ... ejemplo para rellenar tipos de datos complejos

  https://hive.apache.org/developement/quickstart/
  https://stackoverflow.com/questions/77469088/how-to-connect-image-apache-hive-with-image-apache-hadoop
  https://stackoverflow.com/questions/77084507/how-to-build-hive-as-a-service-and-metastore-using-docker-compose

2324
  Cambiar instalación para utilizar tez o spark como motor de ejecución

  Hive y Docker: https://hive.apache.org/developement/quickstart/

  docker pull apache/hive@sha256:3dd36deb83ba7428f6dc9adf07bc9e63d4563f1e088ded8e19dcc860bb9238f7

  docker pull apache/hive:3.1.3
  docker run -d -p 10000:10000 -p 10002:10002 --env SERVICE_NAME=hiveserver2 --name hive4 apache/hive:3.1.3
  docker exec -it hiveserver2 beeline -u 'jdbc:hive2://hiveserver2:10000/'

  https://stackoverflow.com/questions/77469088/how-to-connect-image-apache-hive-with-image-apache-hadoop

  https://stackoverflow.com/questions/77084507/how-to-build-hive-as-a-service-and-metastore-using-docker-compose

  TODO: Al explicar las tablas externas, hacer un ejemplo básico separado del de los campos compuestoss... igual los campos compuestos se pueden ir a la sesión 2...
--->







  
  



  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        <a href='https://ko-fi.com/T6T8GWT9N' title='Invítame a un café en ko-fi.com' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi2.png?v=3' border='0' alt='Invítame a un café en ko-fi.com' /></a>
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="Me encantan estos apuntes" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="Los apuntes son mejorables" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Gracias por tu tiempo. Si quieres me puedes <a href='https://ko-fi.com/T6T8GWT9N'>invitar a un café en ko-fi</a>.
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              ¡Gracias por tu colaboración! Ayúdame a mejorar los apuntes enviándome un mail a <a href="mailto:a.medrano@edu.gva.es">a.medrano@edu.gva.es</a> con tus comentarios.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Pie" >
        
          
          <a href="flume.html" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Flume">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Anterior
              </span>
              <div class="md-ellipsis">
                Flume
              </div>
            </div>
          </a>
        
        
          
          <a href="hive2.html" class="md-footer__link md-footer__link--next" aria-label="Siguiente: Hive II">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Siguiente
              </span>
              <div class="md-ellipsis">
                Hive II
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      2023-2024 Aitor Medrano - <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.es">Licencia CC BY-NC-SA</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://aitor-medrano.github.io/" target="_blank" rel="noopener" title="aitor-medrano.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2m-5.15 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95a8.03 8.03 0 0 1-4.33 3.56M14.34 14H9.66c-.1-.66-.16-1.32-.16-2 0-.68.06-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2M12 19.96c-.83-1.2-1.5-2.53-1.91-3.96h3.82c-.41 1.43-1.08 2.76-1.91 3.96M8 8H5.08A7.923 7.923 0 0 1 9.4 4.44C8.8 5.55 8.35 6.75 8 8m-2.92 8H8c.35 1.25.8 2.45 1.4 3.56A8.008 8.008 0 0 1 5.08 16m-.82-2C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2M12 4.03c.83 1.2 1.5 2.54 1.91 3.97h-3.82c.41-1.43 1.08-2.77 1.91-3.97M18.92 8h-2.95a15.65 15.65 0 0 0-1.38-3.56c1.84.63 3.37 1.9 4.33 3.56M12 2C6.47 2 2 6.5 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/aitormedrano" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:<a.medrano@edu.gva.es>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48H48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0L0 176z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  




  


<h4>Consentimiento de cookie</h4>
<p>Esta página de apuntes utiliza cookies para reconocer las visitas, medir la efectividad de la documentación y averiguar si encuentras aquello que buscas o cómo has llegado a estos apuntes. Con tu consentimiento, me ayudas a mejorar estos materiales.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Aceptar</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Gestionar cookies</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["header.autohide", "navigation.top", "navigation.tracking", "navigation.footer", "navigation.indexes", "content.code.annotate", "announce.dismiss", "toc.follow", "content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>